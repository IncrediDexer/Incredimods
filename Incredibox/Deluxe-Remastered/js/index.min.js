/* 0.5.5 2021-09-22 11:03:35 */
"use strict";var machine={},user={},build={store:"playstore",platform:"mobile",os:"and",storeURL:"https://play.google.com/store/apps/details?id=com.sofarsogood.incredibox",version:"0.5.5"},exclude=!1,showlog=!1,sndtype="mp3",vidtype="mp4",domainOnline="https://sites.google.com/view/niki-incredibox/",appCN=!1,appSQ=!1,appTotalVersion=appCN&&"and"==build.os?4:8;function initGlobal(){try{withAdBreak}catch(t){window.withAdBreak=!1}try{adVisible}catch(t){window.adVisible=!1}}var debugMute=notnull(getParameterByName("mute")),debugGame=notnull(getParameterByName("game")),debugScene=notnull(getParameterByName("scene"));function nada(){}var preventActionUsed=!1,preventActionDelay=.25;function preventAction(t){preventActionUsed||(preventActionUsed=!0,t(),setTimeout(function(){preventActionUsed=!1},preventActionDelay))}function tryfunc(t){notnull(t)&&"function"===(typeof t).toLowerCase()&&t()}function inIframe(){try{return window.self!==window.top}catch(t){return!0}}function callParentWindow(t,e){isIframe&&(notnull(window.top)&&notnull(window.top.appEvent)?window.top.appEvent(t,e):setTimeout(function(){callParentWindow(t,e)},200))}var regexList={allchar:/[*]/,classic:/[^A-Za-z0-9\u00C0-\u017F '-]/,search:/[^A-Za-z0-9\u00C0-\u017F\u0025 '-]/,max3letters:/[*]|(.)(?=\1\1\1)/gi,strict:/[^A-Za-z0-9 '-]/,custom:/[^A-Za-z0-9àâçèéêîôùûÀÂÇÈÉÊÎÔÙÛ '-]/,email:/^(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/,allsafe:/[^A-Za-z0-9\xAA\xB5\xBA\xC0-\xD6\xD8-\xF6\xF8-\u02C1\u02C6-\u02D1\u02E0-\u02E4\u02EC\u02EE\u0370-\u0374\u0376\u0377\u037A-\u037D\u037F\u0386\u0388-\u038A\u038C\u038E-\u03A1\u03A3-\u03F5\u03F7-\u0481\u048A-\u052F\u0531-\u0556\u0559\u0561-\u0587\u05D0-\u05EA\u05F0-\u05F2\u0620-\u064A\u066E\u066F\u0671-\u06D3\u06D5\u06E5\u06E6\u06EE\u06EF\u06FA-\u06FC\u06FF\u0710\u0712-\u072F\u074D-\u07A5\u07B1\u07CA-\u07EA\u07F4\u07F5\u07FA\u0800-\u0815\u081A\u0824\u0828\u0840-\u0858\u0860-\u086A\u08A0-\u08B4\u08B6-\u08BD\u0904-\u0939\u093D\u0950\u0958-\u0961\u0971-\u0980\u0985-\u098C\u098F\u0990\u0993-\u09A8\u09AA-\u09B0\u09B2\u09B6-\u09B9\u09BD\u09CE\u09DC\u09DD\u09DF-\u09E1\u09F0\u09F1\u09FC\u0A05-\u0A0A\u0A0F\u0A10\u0A13-\u0A28\u0A2A-\u0A30\u0A32\u0A33\u0A35\u0A36\u0A38\u0A39\u0A59-\u0A5C\u0A5E\u0A72-\u0A74\u0A85-\u0A8D\u0A8F-\u0A91\u0A93-\u0AA8\u0AAA-\u0AB0\u0AB2\u0AB3\u0AB5-\u0AB9\u0ABD\u0AD0\u0AE0\u0AE1\u0AF9\u0B05-\u0B0C\u0B0F\u0B10\u0B13-\u0B28\u0B2A-\u0B30\u0B32\u0B33\u0B35-\u0B39\u0B3D\u0B5C\u0B5D\u0B5F-\u0B61\u0B71\u0B83\u0B85-\u0B8A\u0B8E-\u0B90\u0B92-\u0B95\u0B99\u0B9A\u0B9C\u0B9E\u0B9F\u0BA3\u0BA4\u0BA8-\u0BAA\u0BAE-\u0BB9\u0BD0\u0C05-\u0C0C\u0C0E-\u0C10\u0C12-\u0C28\u0C2A-\u0C39\u0C3D\u0C58-\u0C5A\u0C60\u0C61\u0C80\u0C85-\u0C8C\u0C8E-\u0C90\u0C92-\u0CA8\u0CAA-\u0CB3\u0CB5-\u0CB9\u0CBD\u0CDE\u0CE0\u0CE1\u0CF1\u0CF2\u0D05-\u0D0C\u0D0E-\u0D10\u0D12-\u0D3A\u0D3D\u0D4E\u0D54-\u0D56\u0D5F-\u0D61\u0D7A-\u0D7F\u0D85-\u0D96\u0D9A-\u0DB1\u0DB3-\u0DBB\u0DBD\u0DC0-\u0DC6\u0E01-\u0E30\u0E32\u0E33\u0E40-\u0E46\u0E81\u0E82\u0E84\u0E87\u0E88\u0E8A\u0E8D\u0E94-\u0E97\u0E99-\u0E9F\u0EA1-\u0EA3\u0EA5\u0EA7\u0EAA\u0EAB\u0EAD-\u0EB0\u0EB2\u0EB3\u0EBD\u0EC0-\u0EC4\u0EC6\u0EDC-\u0EDF\u0F00\u0F40-\u0F47\u0F49-\u0F6C\u0F88-\u0F8C\u1000-\u102A\u103F\u1050-\u1055\u105A-\u105D\u1061\u1065\u1066\u106E-\u1070\u1075-\u1081\u108E\u10A0-\u10C5\u10C7\u10CD\u10D0-\u10FA\u10FC-\u1248\u124A-\u124D\u1250-\u1256\u1258\u125A-\u125D\u1260-\u1288\u128A-\u128D\u1290-\u12B0\u12B2-\u12B5\u12B8-\u12BE\u12C0\u12C2-\u12C5\u12C8-\u12D6\u12D8-\u1310\u1312-\u1315\u1318-\u135A\u1380-\u138F\u13A0-\u13F5\u13F8-\u13FD\u1401-\u166C\u166F-\u167F\u1681-\u169A\u16A0-\u16EA\u16F1-\u16F8\u1700-\u170C\u170E-\u1711\u1720-\u1731\u1740-\u1751\u1760-\u176C\u176E-\u1770\u1780-\u17B3\u17D7\u17DC\u1820-\u1877\u1880-\u1884\u1887-\u18A8\u18AA\u18B0-\u18F5\u1900-\u191E\u1950-\u196D\u1970-\u1974\u1980-\u19AB\u19B0-\u19C9\u1A00-\u1A16\u1A20-\u1A54\u1AA7\u1B05-\u1B33\u1B45-\u1B4B\u1B83-\u1BA0\u1BAE\u1BAF\u1BBA-\u1BE5\u1C00-\u1C23\u1C4D-\u1C4F\u1C5A-\u1C7D\u1C80-\u1C88\u1CE9-\u1CEC\u1CEE-\u1CF1\u1CF5\u1CF6\u1D00-\u1DBF\u1E00-\u1F15\u1F18-\u1F1D\u1F20-\u1F45\u1F48-\u1F4D\u1F50-\u1F57\u1F59\u1F5B\u1F5D\u1F5F-\u1F7D\u1F80-\u1FB4\u1FB6-\u1FBC\u1FBE\u1FC2-\u1FC4\u1FC6-\u1FCC\u1FD0-\u1FD3\u1FD6-\u1FDB\u1FE0-\u1FEC\u1FF2-\u1FF4\u1FF6-\u1FFC\u2071\u207F\u2090-\u209C\u2102\u2107\u210A-\u2113\u2115\u2119-\u211D\u2124\u2126\u2128\u212A-\u212D\u212F-\u2139\u213C-\u213F\u2145-\u2149\u214E\u2183\u2184\u2C00-\u2C2E\u2C30-\u2C5E\u2C60-\u2CE4\u2CEB-\u2CEE\u2CF2\u2CF3\u2D00-\u2D25\u2D27\u2D2D\u2D30-\u2D67\u2D6F\u2D80-\u2D96\u2DA0-\u2DA6\u2DA8-\u2DAE\u2DB0-\u2DB6\u2DB8-\u2DBE\u2DC0-\u2DC6\u2DC8-\u2DCE\u2DD0-\u2DD6\u2DD8-\u2DDE\u2E2F\u3005\u3006\u3031-\u3035\u303B\u303C\u3041-\u3096\u309D-\u309F\u30A1-\u30FA\u30FC-\u30FF\u3105-\u312E\u3131-\u318E\u31A0-\u31BA\u31F0-\u31FF\u3400-\u4DB5\u4E00-\u9FEA\uA000-\uA48C\uA4D0-\uA4FD\uA500-\uA60C\uA610-\uA61F\uA62A\uA62B\uA640-\uA66E\uA67F-\uA69D\uA6A0-\uA6E5\uA717-\uA71F\uA722-\uA788\uA78B-\uA7AE\uA7B0-\uA7B7\uA7F7-\uA801\uA803-\uA805\uA807-\uA80A\uA80C-\uA822\uA840-\uA873\uA882-\uA8B3\uA8F2-\uA8F7\uA8FB\uA8FD\uA90A-\uA925\uA930-\uA946\uA960-\uA97C\uA984-\uA9B2\uA9CF\uA9E0-\uA9E4\uA9E6-\uA9EF\uA9FA-\uA9FE\uAA00-\uAA28\uAA40-\uAA42\uAA44-\uAA4B\uAA60-\uAA76\uAA7A\uAA7E-\uAAAF\uAAB1\uAAB5\uAAB6\uAAB9-\uAABD\uAAC0\uAAC2\uAADB-\uAADD\uAAE0-\uAAEA\uAAF2-\uAAF4\uAB01-\uAB06\uAB09-\uAB0E\uAB11-\uAB16\uAB20-\uAB26\uAB28-\uAB2E\uAB30-\uAB5A\uAB5C-\uAB65\uAB70-\uABE2\uAC00-\uD7A3\uD7B0-\uD7C6\uD7CB-\uD7FB\uF900-\uFA6D\uFA70-\uFAD9\uFB00-\uFB06\uFB13-\uFB17\uFB1D\uFB1F-\uFB28\uFB2A-\uFB36\uFB38-\uFB3C\uFB3E\uFB40\uFB41\uFB43\uFB44\uFB46-\uFBB1\uFBD3-\uFD3D\uFD50-\uFD8F\uFD92-\uFDC7\uFDF0-\uFDFB\uFE70-\uFE74\uFE76-\uFEFC\uFF21-\uFF3A\uFF41-\uFF5A\uFF66-\uFFBE\uFFC2-\uFFC7\uFFCA-\uFFCF\uFFD2-\uFFD7\uFFDA-\uFFDC\s]|\uD800[\uDC00-\uDC0B\uDC0D-\uDC26\uDC28-\uDC3A\uDC3C\uDC3D\uDC3F-\uDC4D\uDC50-\uDC5D\uDC80-\uDCFA\uDE80-\uDE9C\uDEA0-\uDED0\uDF00-\uDF1F\uDF2D-\uDF40\uDF42-\uDF49\uDF50-\uDF75\uDF80-\uDF9D\uDFA0-\uDFC3\uDFC8-\uDFCF]|\uD801[\uDC00-\uDC9D\uDCB0-\uDCD3\uDCD8-\uDCFB\uDD00-\uDD27\uDD30-\uDD63\uDE00-\uDF36\uDF40-\uDF55\uDF60-\uDF67]|\uD802[\uDC00-\uDC05\uDC08\uDC0A-\uDC35\uDC37\uDC38\uDC3C\uDC3F-\uDC55\uDC60-\uDC76\uDC80-\uDC9E\uDCE0-\uDCF2\uDCF4\uDCF5\uDD00-\uDD15\uDD20-\uDD39\uDD80-\uDDB7\uDDBE\uDDBF\uDE00\uDE10-\uDE13\uDE15-\uDE17\uDE19-\uDE33\uDE60-\uDE7C\uDE80-\uDE9C\uDEC0-\uDEC7\uDEC9-\uDEE4\uDF00-\uDF35\uDF40-\uDF55\uDF60-\uDF72\uDF80-\uDF91]|\uD803[\uDC00-\uDC48\uDC80-\uDCB2\uDCC0-\uDCF2]|\uD804[\uDC03-\uDC37\uDC83-\uDCAF\uDCD0-\uDCE8\uDD03-\uDD26\uDD50-\uDD72\uDD76\uDD83-\uDDB2\uDDC1-\uDDC4\uDDDA\uDDDC\uDE00-\uDE11\uDE13-\uDE2B\uDE80-\uDE86\uDE88\uDE8A-\uDE8D\uDE8F-\uDE9D\uDE9F-\uDEA8\uDEB0-\uDEDE\uDF05-\uDF0C\uDF0F\uDF10\uDF13-\uDF28\uDF2A-\uDF30\uDF32\uDF33\uDF35-\uDF39\uDF3D\uDF50\uDF5D-\uDF61]|\uD805[\uDC00-\uDC34\uDC47-\uDC4A\uDC80-\uDCAF\uDCC4\uDCC5\uDCC7\uDD80-\uDDAE\uDDD8-\uDDDB\uDE00-\uDE2F\uDE44\uDE80-\uDEAA\uDF00-\uDF19]|\uD806[\uDCA0-\uDCDF\uDCFF\uDE00\uDE0B-\uDE32\uDE3A\uDE50\uDE5C-\uDE83\uDE86-\uDE89\uDEC0-\uDEF8]|\uD807[\uDC00-\uDC08\uDC0A-\uDC2E\uDC40\uDC72-\uDC8F\uDD00-\uDD06\uDD08\uDD09\uDD0B-\uDD30\uDD46]|\uD808[\uDC00-\uDF99]|\uD809[\uDC80-\uDD43]|[\uD80C\uD81C-\uD820\uD840-\uD868\uD86A-\uD86C\uD86F-\uD872\uD874-\uD879][\uDC00-\uDFFF]|\uD80D[\uDC00-\uDC2E]|\uD811[\uDC00-\uDE46]|\uD81A[\uDC00-\uDE38\uDE40-\uDE5E\uDED0-\uDEED\uDF00-\uDF2F\uDF40-\uDF43\uDF63-\uDF77\uDF7D-\uDF8F]|\uD81B[\uDF00-\uDF44\uDF50\uDF93-\uDF9F\uDFE0\uDFE1]|\uD821[\uDC00-\uDFEC]|\uD822[\uDC00-\uDEF2]|\uD82C[\uDC00-\uDD1E\uDD70-\uDEFB]|\uD82F[\uDC00-\uDC6A\uDC70-\uDC7C\uDC80-\uDC88\uDC90-\uDC99]|\uD835[\uDC00-\uDC54\uDC56-\uDC9C\uDC9E\uDC9F\uDCA2\uDCA5\uDCA6\uDCA9-\uDCAC\uDCAE-\uDCB9\uDCBB\uDCBD-\uDCC3\uDCC5-\uDD05\uDD07-\uDD0A\uDD0D-\uDD14\uDD16-\uDD1C\uDD1E-\uDD39\uDD3B-\uDD3E\uDD40-\uDD44\uDD46\uDD4A-\uDD50\uDD52-\uDEA5\uDEA8-\uDEC0\uDEC2-\uDEDA\uDEDC-\uDEFA\uDEFC-\uDF14\uDF16-\uDF34\uDF36-\uDF4E\uDF50-\uDF6E\uDF70-\uDF88\uDF8A-\uDFA8\uDFAA-\uDFC2\uDFC4-\uDFCB]|\uD83A[\uDC00-\uDCC4\uDD00-\uDD43]|\uD83B[\uDE00-\uDE03\uDE05-\uDE1F\uDE21\uDE22\uDE24\uDE27\uDE29-\uDE32\uDE34-\uDE37\uDE39\uDE3B\uDE42\uDE47\uDE49\uDE4B\uDE4D-\uDE4F\uDE51\uDE52\uDE54\uDE57\uDE59\uDE5B\uDE5D\uDE5F\uDE61\uDE62\uDE64\uDE67-\uDE6A\uDE6C-\uDE72\uDE74-\uDE77\uDE79-\uDE7C\uDE7E\uDE80-\uDE89\uDE8B-\uDE9B\uDEA1-\uDEA3\uDEA5-\uDEA9\uDEAB-\uDEBB]|\uD869[\uDC00-\uDED6\uDF00-\uDFFF]|\uD86D[\uDC00-\uDF34\uDF40-\uDFFF]|\uD86E[\uDC00-\uDC1D\uDC20-\uDFFF]|\uD873[\uDC00-\uDEA1\uDEB0-\uDFFF]|\uD87A[\uDC00-\uDFE0]|\uD87E[\uDC00-\uDE1D]/};function isEmpty(t){return 0===Object.keys(t).length&&t.constructor===Object}function countObj(t){var e,o=0;for(e in t)t.hasOwnProperty(e)&&o++;return o}function removeDupInArray(t,e){var o=[];for(var i of t)existInArray(o,i,e)||o.push(i);return o}function uniqueBetweenArray(t,e,o){var i,n=[];for(i of t)existInArray(e,i,o)||n.push(i);for(i of e)existInArray(t,i,o)||n.push(i);return n}function existInArray(t,e,o){for(var i=!notnull(o)||o,n=!1,s=0,a=t.length;s<a;s++)if(i){if(t[s]===e){n=!0;break}}else if(t[s].toLowerCase()===e.toLowerCase()){n=!0;break}return n}function removeInArray(t,e){for(var o=0,i=e.length;o<i;o++)if(e[o]===t){e.splice(o,1);break}return e}function removeInArrayFromProp(t,e,o){for(var i=0,n=o.length;i<n;i++)if(o[i][e]===t){o.splice(i,1);break}return o}function existInArrayFromProp(t,e,o){for(var i=0,n=o.length;i<n;i++)if(o[i][e]===t)return!0;return!1}function numberArray(t){for(var e=0,o=t.length;e<o;e++)t[e]=0|t[e];return t}function windowPopup(t,e,o,i){var n=i?screen.height/2-o/2:0,s=i?screen.width/2-e/2:0;window.open(t,"","menubar=no,toolbar=no,resizable=yes,scrollbars=yes,width="+e+",height="+o+",top="+n+",left="+s)}function xhr(t,e,o,i,n){var s=n||function(){};$.ajax({type:t,url:e,crossdomain:!0,data:o,success:function(t){i(t,o)},error:s,dataType:"json"})}function assetName(t){var e="";switch(assetSize){case"hd":e=nameToHD(t);break;default:e=t}return e}function animeName(t){var e="";switch(animeSize){case"hd":e=nameToHD(t);break;default:e=t}return e}function nameToHD(t){var e=t.substr(t.lastIndexOf("."));return t.split(e).join("-hd"+e)}function loadImg(t,e){var o="object"!=typeof t[0]?[t]:t,i=o.length,n=0;function s(){var t=o[n][0],e=o[n][1],i=new Image;i.onload=function(){$(e).css({"background-image":"url("+t+")"}),a()},i.onerror=function(){var e=t.split("/"),o=e[e.length-1];boxDialog.open("Preloading IMG "+o,"ERROR",["Relaod","Continue"],[gotoAppUrl,a],!0)},i.src=t}function a(){(++n==i?e:s)()}s()}function loadSnd(t,e,o,i){var n=new XMLHttpRequest;n.open("GET",t,!0),n.responseType="arraybuffer",n.onload=function(){e.decodeAudioData(n.response,function(t){o(t)},function(t){i()})},n.onerror=function(){i()},n.send()}function gotoAppUrl(t){var e=isnull(t)?appBrowser?"":"index.html":t;window.location.href=e}function openURL(t,e){var o=isIframe?window.top:window;appDesktop?_electron.shell.openExternal(t):(e=isnull(e)?"_blank":e,e=appMobile?"_system":e,trustAppMobile&&isIOS?cordova.InAppBrowser.open(t,"_system","hidden=yes,location=no"):o.open(t,e))}function redirectTo(t){var e=domainOnline+"url/"+t;if(e=appCN?e+"-cn":e,appMobile)switch(t){case"facebook":e=isIOS?"fb://page?id=182619895103489":"fb://page/182619895103489";break;case"twitter":e="https://twitter.com/incredibox_";break;case"instagram":e="https://www.instagram.com/incredibox.official/";break;case"youtube":e="https://www.youtube.com/c/incredibox"}saveGA("redirection","open_url",e),openURL(e)}function getParameterByName(t){var e={},o=(window.location.href.replace(/[?&]+([^=&]+)=([^&]*)/gi,function(t,o,i){e[o]=i}),null);return t in e&&(o=e[t]),o}function getParameter(){return window.location.search}function getPageName(){return window.location.href.split("/").pop()}function getPageNameGA(){return-1!=window.location.href.indexOf("app.html")?"app.html?v="+getParameterByName("v"):"index.html"}function secToText(t){parseInt(t%1e3/100);var e=parseInt(t/1e3%60),o=parseInt(t/6e4%60),i=parseInt(t/36e5%24);return i=i<10?"0"+i:i,(o=o<10?"0"+o:o)+":"+(e=e<10?"0"+e:e)}function getTime(){return(new Date).getTime()}function getTimeAgo(t,e){t=-1==t.indexOf("/")?t.split("-").join("/"):t,e=-1==e.indexOf("/")?e.split("-").join("/"):e;var o=new Date(t),i=timeConversion(new Date(e).getTime()-o.getTime());return!1===i?getStringDate(t):i}function timeConversion(t){var e=(t/1e3).toFixed(1),o=(t/6e4).toFixed(1),i=(t/36e5).toFixed(1),n=(t/864e5).toFixed(1),s="";if(e<60){var a=Math.round(e);s=a.toString()+" "+(a<2&&notnull(STR("txt.time.tSec.one"))?STR("txt.time.tSec.one"):STR("txt.time.tSec.other"))}else if(o<60){var u=Math.round(o);s=u.toString()+" "+(u<2&&notnull(STR("txt.time.tMin.one"))?STR("txt.time.tMin.one"):STR("txt.time.tMin.other"))}else if(i<23){var r=Math.round(i);s=r.toString()+" "+(r<2&&notnull(STR("txt.time.tHou.one"))?STR("txt.time.tHou.one"):STR("txt.time.tHou.other"))}else{if(!(n<10))return!1;var c=Math.round(n);s=c.toString()+" "+(c<2&&notnull(STR("txt.time.tDay.one"))?STR("txt.time.tDay.one"):STR("txt.time.tDay.other"))}return STR("txt.ago").split("%{date_time}").join(s)}function getDateNow(){var t=new Date,e=t.getDate(),o=t.getMonth()+1,i=t.getFullYear(),n=t.getHours(),s=t.getMinutes(),a=t.getSeconds();return e=e<10?String("0"+e):String(e),o=o<10?String("0"+o):String(o),n=n<10?n=String("0"+n):String(n),s=s<10?s=String("0"+s):String(s),a=a<10?a=String("0"+a):String(a),String(i+"-"+o+"-"+e+" "+n+":"+s+":"+a)}function jsonDecode(t){if(isnull(t))return null;var e=t.split("\t").join("").split("\n").join("");return JSON.parse(e)}function jsonEncode(t){return isnull(t)?null:JSON.stringify(t)}function random(t){return Math.round(Math.random()*t)}function decimal(t,e){e=isnull(e)?2:e;var o=Math.pow(10,e);return Math.round(t*o)/o}function numberSpaced(t){var e=t.toString(),o=e.indexOf(".");return e.replace(/\d(?=(?:\d{3})+(?:\.|$))/g,function(t,e){return o<0||e<o?t+" ":t})}function trim(t){return isnull(t)?"":t=(t=(t=(t=t.split("\t").join("")).split("\n").join("")).split("\r").join("")).replace(/^\s+|\s+$|\s+(?=\s)/g,"")}function cleanInputText(t,e){return t=(t=trim(t=ucwords(t))).replace(regexList.max3letters,""),e.val(t),t}function slugify(t){new RegExp("àáäâãåèéëêìíïîòóöôùúüûñçßÿœæŕśńṕẃǵǹḿǘẍźḧ·/_,:;".split("").join("|"),"g");return t.toString().toLowerCase().replace(/\s+/g,"-").replace(/&/g,"-and-").replace(/[^\w\-]+/g,"").replace(/\-\-+/g,"-").replace(/^-+/,"")}function addMiddleBreak(t){var e=t.split(" "),o=e.length-1,i=Math.ceil(o/2);return e[i]=e[i]+"<br>",e.join(" ")}function ucwords(t){return(t=t.toLowerCase()).charAt(0).toUpperCase()+t.slice(1)}function uniqnum(){return Math.floor((new Date).valueOf()*Math.random())}function uniqid(t){var e=t||"";function o(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1)}return o()+e+o()+e+o()+e+o()+e+o()}function getUniqLink(t){var e=notnull(t)?t.app:app.version;return uniqid()+"-v"+e}function isnull(t){return null===t||void 0===t||"undefined"===t}function notnull(t){return null!==t&&void 0!==t&&"undefined"!==t}function isFunction(t){return t&&"[object Function]"==={}.toString.call(t)}function copyToClipboard(t){var e=document.createElement("textarea");e.value=t,e.setAttribute("readonly",""),e.style={position:"absolute",visibility:"hidden",pointerEvents:"none"},document.body.appendChild(e),e.select(),document.execCommand("copy"),document.body.removeChild(e)}function resetAnimationCSS(t){t.style.animation="none",t.offsetHeight,t.style.animation=null}function transitionEndEventName(){var t,e=document.createElement("div"),o={transition:"transitionend",OTransition:"oTransitionEnd",MozTransition:"transitionend",WebkitTransition:"webkitTransitionEnd"};for(t in o)if(o.hasOwnProperty(t)&&void 0!==e.style[t])return o[t];return null}function animationEndEventName(){var t,e=document.createElement("div"),o={animation:"animationend",OAnimation:"oanimationend",MozAnimation:"animationend",WebkitAnimation:"webkitAnimationEnd"};for(t in o)if(o.hasOwnProperty(t)&&void 0!==e.style[t])return o[t];return null}function listenTransition(t,e,o,i){i=!!notnull(i)&&i,t.off(transitionEnd).on(transitionEnd,{div:t,prop:e,func:o,log:i},transitionComplete)}function addTransition(t,e,o,i,n){n=!!notnull(n)&&n,t.off(transitionEnd).addClass(e).on(transitionEnd,{div:t,prop:o,func:i,log:n},transitionComplete)}function removeTransition(t,e,o,i,n){n=!!notnull(n)&&n,t.off(transitionEnd).removeClass(e).on(transitionEnd,{div:t,prop:o,func:i,log:n},transitionComplete)}function transitionComplete(t){notnull(t.data)&&notnull(t.data.func)&&t.originalEvent.propertyName.replace("-webkit-","")==t.data.prop&&t.data.div.attr("id")==t.target.id&&(notnull(t.data.log),t.data.div.off(transitionEnd),t.data.func())}function getCSSMatrix(t){if(!isnull(t)){var e=t.css("-webkit-transform")||t.css("-moz-transform")||t.css("-ms-transform")||t.css("-o-transform")||t.css("transform");return isnull(e)?[1]:e.replace(/[^0-9\-.,]/g,"").split(",")}return[1]}function getScale(t){return getCSSMatrix(t)[0]}function cssAnimate(t,e){t.addClass(e).one(animationEnd,function(t){$(t.target).removeClass(e)})}function getEvents(t){var e=$._data(t,"events"),o=$._data(document,"events");for(var i in o)if(o.hasOwnProperty(i))for(var n=o[i],s=0;s<n.length;s++)$(t).is(n[s].selector)&&(null==e&&(e={}),e.hasOwnProperty(i)||(e[i]=[]),e[i].push(n[s]));return e}function stopProp(t){notnull(t)&&t.stopPropagation()}String.prototype.replaceAt=function(t,e){return this.substr(0,t)+e+this.substr(t+e.length)};var templateW=1024,templateH=768,stageScale=1,pictoScale=1,poloScale=1,popupScale=1,mixlistScale=1,extendVideo=!1,ultrawide=!1;function getScreenSize(){if(screenW=document.body.offsetWidth,screenH=document.body.offsetHeight,viewportW=Math.max(document.documentElement.clientWidth||0,window.innerWidth||0),viewportH=Math.max(document.documentElement.clientHeight||0,window.innerHeight||0),trustAppMobile?(screenW=screen.width,screenH=screen.height,isAndroid&&(viewportW>0&&viewportW<screenW||viewportH>0&&viewportH<screenH)&&(screenW=viewportW,screenH=viewportH)):(screenW=document.body.offsetWidth,screenH=document.body.offsetHeight),isIOS&&screenH>screenW){var t=screenW;screenW=screenH,screenH=t}}function resizeApp(){getScreenSize(),trustAppMobile&&isIOS&&$("html").css({position:"relative",width:screenW+"px",height:screenH+"px"});var t,e=$("#app-incredibox"),o=$("#mixlist");$("body").hasClass("fluid")&&(t=screenW*templateH/screenH,e.height(templateH),e.width(t),stageScale=screenH/templateH,e.css({transform:"scale("+stageScale+")"}),(ultrawide=screenW/screenH>=1.8)&&$("body").addClass("ultrawide"),checkMobile()&&($("body").addClass("mobile"),popupScale=1.8,poloScale=1.15,pictoScale=1.15,mixlistScale=1.3));var i=e.height(),n=e.width();if(pageApp){var s="<style type='text/css'>",a=$("#box-top").height(),u=$("#box-bottom").height(),r=parseInt($("#box-bottom").css("top")),c=i-u-a,p=n,l=getAppBound();s+="#lock-pause #top-resume{ height:"+a+"px; }",s+="#game { background-position: 0px "+a+"px; background-size:100% "+c+"px;}",s+="#lock-stage{ top:"+a+"px; }",s+="#box-reading-bar{ top:"+a+"px; }";var d,f,v=400*p/1e3;if(v<c)d=c,f=1e3*c/400;else{f=p;var m=a+(d=v)-r;if(m>60){extendVideo=!0;var h=m;r+h>i-a&&(d=i-2*a,h=u-a),s+="#game #box-bottom.bottomSlide{ transform:translate3d(0px,"+h+"px,0px);}",s+=".box-popup.mini .bac, .box-popup.mini .flex { transition: bottom .3s ease-in-out; }",s+=".box-popup.bottomSlide.mini .bac, .box-popup.bottomSlide.mini .flex { bottom: "+a+"px!important; }"}else d=c}$("#box-video").css({top:a+"px",width:Math.round(f)+"px",height:Math.round(d)+"px"}),$("#fade-video").css({top:a+"px",height:d+"px"}),$("#box-stage").css({transform:"scale("+poloScale+")","transform-origin":"center bottom"}),$("#box-loader-polo").css({transform:"scale("+poloScale+")","transform-origin":"center top"}),$("#stage-overflow").css({height:Math.floor(400/poloScale)+"px"}),$("#box-picto").css({transform:"scale("+pictoScale+")"}),$("#mixlist .scale").css({transform:"scale("+mixlistScale+")"}),$("#mixlist").css("height",l.height/stageScale+l.top+"px"),$("#mixlist #poplist").css("height",Math.round(($("#mixlist").height()-parseFloat($("#mixlist #poplist").css("top")))/mixlistScale)+"px"),s+="</style>",$(s).appendTo("head")}if(getAppSizeInfo(),appDesktop&&!$("body").hasClass("fluid")){var b,g=templateH+(1100-templateH);$(window).resize(function(){getScreenSize(),b=Math.round((screenH-templateH)/2),screenH>1100?(stageScale=screenH/g,e.css({transform:"scale("+stageScale+")"})):stageScale>1&&(stageScale=1,e.css({transform:"scale("+stageScale+")"})),pageApp&&(o.css("height",templateH+b+"px"),resetStagePosition()),getAppSizeInfo()}),$(window).resize()}if(!appBrowser||appBrowserDemo||appBrowserExpo||($(window).resize(function(){getScreenSize(),stageScale=(stageScale=screenH/templateH)>1?1:stageScale,e.css({transform:"scale("+stageScale+")"}),pageApp&&resetStagePosition()}),$(window).resize()),appBrowserExpo){var x=stageScale;templateH=screenH,$(window).resize(function(){getScreenSize(),stageScale=screenH*x/templateH,e.css({transform:"scale("+stageScale+")"}),resetStagePosition()}),$(window).resize()}$("body").css({visibility:"visible"})}function getAppBound(){return document.getElementById("app-incredibox").getBoundingClientRect()}function getAppSizeInfo(){getAppBound()}function resetStagePosition(){if(appLoaded){for(var t=0;t<nbData;t++)listPicto[t].setPosition();for(t=0;t<app.nbpolo;t++)listPolo[t].setPosition()}}var appMobile="mobile"==build.platform,appDesktop="desktop"==build.platform,appBrowser="browser"==build.platform,appBrowserDemo=!1,appBrowserExpo=!1,pageExt=appMobile||appDesktop?"html":"php",isMouseDevice=checkMouseDevice(),isTouchDevice=checkTouchDevice(),isHybridDevice=isMouseDevice&&isTouchDevice,isTouchCapable=isTouchDevice||isHybridDevice,isComputer=checkAppDesktop()||checkInBrowser(),trustAppMobile=(window.hasOwnProperty("cordova")||"object"==typeof cordova)&&void 0!=window.cordova,trustAppDesktop=window.hasOwnProperty("_electron")||"_electron"==typeof cordova,isIframe=inIframe(),isMiniDevice=!1,isMobile=!1,isOpera=!appMobile&&!appDesktop&&checkIsOpera(),evtClick,evtPress,evtPressEnd,evtMove,isIOS=!1,isOSX=!1,isWin=!1,isAndroid=!1,isiPod=!1,isiPhone=!1,isiPhone5=!1,isiPhone6s=!1,isiPhone6sAndMore=!1,isiPhoneX=!1,isiPad=!1,isiPadPro=!1,hasWorker=window.Worker||!1,hasHBI=!1,screenW,screenH,viewportW,viewportH,isRetina=!1,assetSize="",animeSize="",isAssetHD=!1,isAnimeHD=!1;function checkSystem(){if(hasNetwork=networkState(),machine=getDeviceInfo(!0),user=getUserInfo(),isAndroid=/android/i.test(machine.osName),isWin=/windows/i.test(machine.osName),isOSX=/mac os/i.test(machine.osName),isIOS=/ios/i.test(machine.osName),getScreenSize(),isiPod=isIOS&&/ipod/i.test(machine.osName),isiPhone=isIOS&&/iphone/i.test(machine.osName),isiPhone5=isiPhone&&5==machine.deviceNumber,isiPhone6s=trustAppMobile&&isiPhone&&/iPhone8,/i.test(device.model)&&!/iPhone8,4/i.test(device.model)||isiPhone&&6==machine.deviceNumber,isiPhone6sAndMore=isiPhone&&(isiPhone6s||machine.deviceNumber>6),isiPhoneX=isiPhone&&10==machine.deviceNumber,isiPad=isIOS&&/ipad/i.test(machine.deviceModel),isiPadPro=isiPad&&checkiPadPro(),isRetina=checkRetina(),isMobile=checkMobile(),isMiniDevice=checkMiniDevice(),hasHBI=isIOS&&checkHBI(),trustAppMobile&&(screenW>1024&&screenH>768&&window.devicePixelRatio>1&&(assetSize="hd",animeSize="hd"),isIOS&&((isiPad||isiPhone&&machine.deviceNumber>5)&&(assetSize="hd"),isiPadPro&&(animeSize="hd"))),isAssetHD="hd"==assetSize,isAnimeHD="hd"==animeSize,"hd"==assetSize&&$("img").each(function(t){var e=$(this).attr("src");"svg"!=e.split(".")[1]&&$(this).attr("src",nameToHD(e))}),appBrowser&&(sndtype=checkAudioFormat("ogg")?"ogg":sndtype,vidtype="mozilla firefox"==machine.browserName&&machine.browserVersion<=48?"webm":"mp4"),setPointerEvent(),appDesktop&&($("body").addClass("appDesktop"),document.body.classList.add("appDesktop"),document.body.classList.add("noPadding")),!appBrowser||appBrowserDemo||appBrowserExpo||($("body").addClass("appBrowser"),$("body").addClass("noPadding")),appBrowserDemo&&($("body").addClass("appBrowserDemo"),$("body").addClass("fluid")),appMobile&&$("body").addClass("fluid"),isMouseDevice&&!isTouchDevice&&$("body").addClass("mouseEvent"),hasHBI&&$("body").addClass("hasHBI"),isiPhoneX&&$("body").addClass("iPhoneX"),isOpera&&$("body").addClass("isOpera"),trustAppDesktop&&"steam"==build.store&&"YXJw"!=btoa(_electron.app.commandLine.getSwitchValue("arg")))throw new BoxDialog("#pop-dialog").open("Incredibox needs to run from<br>your Steam library.<br>Thanks for your support!","&#129488;",[],!0,!0),new Error("Please connect to your Steam account")}function checkHBI(){if(trustAppMobile){if(isiPad&&!/11,1|11,2|11,3|11,4|11,6|11,7/i.test(device.model)&&parseInt(device.model.replace("iPad","").split(",")[0]>=8))return!0;if(isiPhone&&!/10,1|10,2|10,4|10,5|12,8/i.test(device.model)&&parseInt(device.model.replace("iPhone","").split(",")[0]>=10))return!0}return!1}function getListUUID(){var t=[];t.push(machine.uuid);var e=storage.getAllItem();for(var o in e){if(-1!=o.indexOf("uuid-"))""!=o.replace("uuid-","")?t.push(o.replace("uuid-","")):storage.removeItem(o)}return removeDupInArray(t,!1)}function functionExist(){"function"!=typeof initAnalytics&&(window.self.initAnalytics=function(){return!1},window.self.saveGA=function(){return!1})}function secureIframe(){}function checkInBrowser(){return document.URL.indexOf("http://")>-1||document.URL.indexOf("https://")>-1}function checkOnDevice(){return!!navigator.userAgent.match(/(iPhone|iPod|iPad|Android)/)}function checkMobile(){return!!(isiPod||isiPhone||screenW<=926&&screenH<=504)}function checkMiniDevice(){return!isComputer&&(screenW<=568&&!isRetina)}function checkRetina(){return window.devicePixelRatio>1||!(!window.matchMedia||!window.matchMedia("(-webkit-min-device-pixel-ratio: 1.5), (min--moz-device-pixel-ratio: 1.5), (-o-min-device-pixel-ratio: 3/2), (min-resolution: 1.5dppx)").matches)}function checkAppDesktop(){return navigator.userAgent.toLowerCase().indexOf(" electron/")>-1}function checkIsOpera(){var t=navigator.userAgent.toLowerCase();return t.indexOf("opera")>-1||t.indexOf("opr")>-1}function checkTouchDevice(){var t=!1;try{document.createEvent("TouchEvent"),t=!0}catch(t){}return("ontouchstart"in window||navigator.maxTouchPoints>0||navigator.msMaxTouchPoints>0)&&(t=!0),window.matchMedia("(pointer: coarse)").matches&&(t=!0),t}function checkMouseDevice(){var t=!1;return window.matchMedia("(hover: hover)").matches&&window.matchMedia("(pointer: fine)").matches&&(t=!0),t}function getAppData(){return{build:build,machine:machine,user:user}}function checkAudioFormat(t){t=t||"mp3";var e=document.createElement("audio");return!(!e.canPlayType||!e.canPlayType("audio/"+t+";").replace(/no/,""))}function checkSupported(){var t=!!window.HTMLCanvasElement,e=window.AudioContext||window.webkitAudioContext||!1,o="string"==typeof(new XMLHttpRequest).responseType,i=!isnull(transitionEnd)&&!isnull(animationEnd);return window.AudioContext=e,t?e?o?i?"ok":"CSS3 is not supported":"XHR is not supported":"Audio API is not supported":"Canvas is not supported"}function setPointerEvent(){isHybridDevice&&!isIOS?(evtClick="touchstart click",evtPress="touchstart mousedown",evtPressEnd="touchend mouseup",evtMove="touchmove mousemove"):isTouchDevice?(evtClick="touchstart",evtPress="touchstart",evtPressEnd="touchend",evtMove="touchmove"):(evtClick="click",evtPress="mousedown",evtPressEnd="mouseup",evtMove="mousemove")}function initRightClick(){}function networkOn(){hasNetwork=!0,gaShouldTrack&&!gaAlreadySet&&initAnalytics(),storage.restoreAllMix()}function networkOff(){hasNetwork=!1}function networkState(){var t=!1;return notnull(navigator.onLine)?t=navigator.onLine:notnull(navigator.network)&&(t=!(navigator.network.connection.type==Connection.NONE)),t}function bugBluetoothLatency(){return!notnull(getParameterByName("bluetooth"))&&(!!(trustAppMobile&&isAndroid&&contextAudio.baseLatency>.2&&window.hasOwnProperty("bluetoothle"))&&(bluetoothle.initialize(function(t){switch(t.status){case"enabled":bluetoothle.disable();break;case"disabled":$("#fade-all").removeClass(),boxDialog.open(STR("dial.bluetoothLatencyText"),STR("dial.bluetoothLatencyTitle"),[STR("bt.ok")],[function(){window.location.href="?v="+appNumberVersion+"&bluetooth=1"}])}},{statusReceiver:!0}),!0))}function bugSampleRate(){return!1}window.devicePixelRatio=window.devicePixelRatio||1,functionExist(),secureIframe();var audioPort="";function checkAudioRoute(){}function checkStateAudioContext(){notnull(contextAudio)&&"interrupted"==contextAudio.state&&(contextAudio.resume(),rebuildAudioContext())}function rebuildAudioContext(){var t=contextAudio.createBuffer(1,1,44100),e=contextAudio.createBufferSource();e.buffer=t,e.connect(contextAudio.destination),e.start(0),e.disconnect(),contextAudio.close(),(contextAudio=new AudioContext).onstatechange=listenStateAudioCtx()}function listenStateAudioCtx(){}function initSilentMode(){}function detectSilentMode(){}var immersiveMode=!1;function launchImmersiveMode(){trustAppMobile&&isAndroid&&!immersiveMode&&(immersiveMode=!0,AndroidFullScreen.isSupported(function(){AndroidFullScreen.isImmersiveModeSupported(function(){AndroidFullScreen.setSystemUiVisibility(AndroidFullScreen.SYSTEM_UI_FLAG_LAYOUT_STABLE|AndroidFullScreen.SYSTEM_UI_FLAG_LAYOUT_HIDE_NAVIGATION|AndroidFullScreen.SYSTEM_UI_FLAG_LAYOUT_FULLSCREEN|AndroidFullScreen.SYSTEM_UI_FLAG_HIDE_NAVIGATION|AndroidFullScreen.SYSTEM_UI_FLAG_FULLSCREEN|AndroidFullScreen.SYSTEM_UI_FLAG_IMMERSIVE_STICKY,function(){},function(){}),AndroidFullScreen.immersiveMode(function(){},errorImmersiveMode)},errorImmersiveMode)},errorImmersiveMode))}function errorImmersiveMode(t){}function getUserInfo(){return{guid:storage.getItem("user-guid")||"",djname:storage.getItem("user-djname")||"",lang:storage.getItem("user-lang")||""}}function setUserInfo(t){notnull(t.guid)&&(user.guid=t.guid,storage.setItem("user-guid",user.guid),cloud.save("user-guid",user.guid)),notnull(t.djname)&&(user.djname=t.djname,storage.setItem("user-djname",user.djname),cloud.save("user-djname",user.djname)),notnull(t.lang)&&(user.lang=t.lang,storage.setItem("user-lang",user.lang),cloud.save("user-lang",user.lang)),user=getUserInfo()}function getDeviceInfo(t){var e,o,i,n=navigator.userAgent||navigator.vendor||window.opera,s=n.toLowerCase(),a="(?)";/(fban|fbios|fbav|fbbv|fbid)/gi.test(s)?a="Facebook":/(twitter)/gi.test(s)&&(a="Twitter");var u="(?)";trustAppMobile?u=device.platform:/(windows|win16)/gi.test(s)?u="Windows":/(android)/gi.test(s)?u="Android":/(iphone|ipad|ipod)/gi.test(s)?u="iOS":/(mac os x)/gi.test(s)?u="Mac OS X":/(macppc|macintel|mac_powerpc|macintosh)/gi.test(s)&&(u="Mac OS");var r="(?)",c=s;trustAppMobile&&(c=device.model),/(windows phone|windows phone)/gi.test(c)?r="Windows phone":/(windows|win16)/gi.test(c)?r="PC":/(android)/gi.test(c)?r="Android":/(ipad)/gi.test(c)?r="iPad":/(iphone)/gi.test(c)?r="iPhone":/(ipod)/gi.test(c)?r="iPod":/(mac)/gi.test(c)&&(r="Mac");var p="(?)";trustAppMobile?p=device.model:void 0!=window.navigator&&void 0!=navigator.platform&&(p=navigator.platform);var l="(?)";trustAppMobile?l=device.version:"Windows"==u?/(windows 10.0|windows nt 10.0)/gi.test(s)?l="10":/(windows 8.1|windows nt 6.3)/gi.test(s)?l="8.1":/(windows 8|windows nt 6.2)/gi.test(s)?l="8":/(windows 7|windows nt 6.1)/gi.test(s)?l="7":/(windows nt 6.0)/gi.test(s)?l="Vista":/(windows nt 5.2)/gi.test(s)?l="Server 2003":/(windows nt 5.1|windows xp)/gi.test(s)?l="XP":/(windows nt 5.0|windows 2000)/gi.test(s)?l="2000":/(win 9x 4.90|windows me)/gi.test(s)?l="ME":/(windows 98|win98)/gi.test(s)?l="98":/(windows 95|win95|windows_95)/gi.test(s)?l="95":/(windows nt 4.0|winnt4.0|winnt|windows nt)/gi.test(s)?l="NT 4.0":/(windows ce)/gi.test(s)?l="CE":/(win16)/gi.test(s)&&(l="3.11"):"Android"==u?(e="Android",o=n.toLowerCase().indexOf(e.toLowerCase()),i=parseFloat(n.slice(o+e.length,o+e.length+6)),l=isNaN(i)?l:i):"iOS"==u?(e="OS",o=n.toLowerCase().indexOf(e.toLowerCase()),i=n.slice(o+e.length,o+e.length+6),i=parseFloat(i.replace("_",".")),l=isNaN(i)?l:i):-1!=u.indexOf("Mac OS")&&(e=-1!=u.indexOf("Mac OS X")?"Mac OS X":"Mac OS",o=n.toLowerCase().indexOf(e.toLowerCase()),i=n.slice(o+e.length,o+e.length+6),i=parseFloat(i.replace("_",".")),l=isNaN(i)?l:i);var d=0;if("iOS"==u)if(trustAppMobile)void 0!=appleModel[device.model]&&"iPhone"==r&&(d=appleModel[device.model].replace("iPhone","").split(" ")[0],d=/SE/i.test(d)?7:/X/i.test(d)?10:parseInt(d));else if("iPhone"==r){var f=window.screen.width,v=window.screen.height;320==f&&480==v?d=4:320==f&&568==v?d=5:375==f&&667==v?d=6:414==f&&736==v?d=6:375==f&&812==v?d=10:414==f&&896==v&&(d=10),3==window.devicePixelRatio&&(812==f&&375==v||896==v&&414==f)&&(d=10)}var m="";trustAppMobile?m=build.os:/mac os/i.test(u)?m="osx":/windows/i.test(u)?m="win":/android/i.test(u)?m="and":/ios/i.test(u)&&(m="ios");navigator.appVersion;var h,b,g,x=navigator.appName,D=""+parseFloat(navigator.appVersion),C=parseInt(navigator.appVersion,10);-1!=(b=n.indexOf("OPR/"))?(x="Opera",D=n.substring(b+4)):-1!=(b=n.indexOf("Opera"))?(x="Opera",D=n.substring(b+6),-1!=(b=n.indexOf("Version"))&&(D=n.substring(b+8))):-1!=(b=n.indexOf("Edge"))?(x="Microsoft Edge",D=n.substring(b+5)):-1!=(b=n.indexOf("MSIE"))?(x="Microsoft Internet Explorer",D=n.substring(b+5)):-1!=(b=n.indexOf("Trident"))?(x="Microsoft Internet Explorer",-1!=(b=n.indexOf("rv:"))&&(D=n.substring(b+3))):-1!=(b=n.indexOf("CriOS"))&&/iphone|ipod|ipad/i.test(n)?(x="Google Chrome for IOS",D=n.substring(b+6)):-1!=(b=n.indexOf("Chrome"))?(x="Google Chrome",D=n.substring(b+7)):-1!=(b=n.indexOf("Safari"))?(x="Safari",D=n.substring(b+7),-1!=(b=n.indexOf("Version"))&&(D=n.substring(b+8))):-1!=(b=n.indexOf("Firefox"))?(x="Mozilla Firefox",D=n.substring(b+8)):(h=n.lastIndexOf(" ")+1)<(b=n.lastIndexOf("/"))&&(x=n.substring(h,b),D=n.substring(b+1),x.toLowerCase()==x.toUpperCase()&&(x=navigator.appName)),-1!=(g=D.indexOf(";"))&&(D=D.substring(0,g)),-1!=(g=D.indexOf(" "))&&(D=D.substring(0,g)),C=parseInt(""+D,10),isNaN(C)&&(D=""+parseFloat(navigator.appVersion),C=parseInt(navigator.appVersion,10));var k="";trustAppMobile?k=device.uuid:appDesktop?k=_electron.machine.machineIdSync():notnull(storage.getItem("tmp-uuid"))?k=storage.getItem("tmp-uuid"):(k="tmp-"+uniqid("-"),storage.setItem("tmp-uuid",k));var w={osName:u,osTiny:m,osVersion:l.toString(),deviceModel:r,deviceName:p,deviceNumber:d,browserName:x,browserVersion:C,browserFullVersion:D,browserAppName:navigator.appName,browserUserAgent:navigator.userAgent,language:navigator.language||"",webviewEmbed:a,uuid:k};if(!0===t)for(var $ in w)"string"==typeof w[$]&&(w[$]=w[$].toLowerCase());if(trustAppMobile)for(var A in device);for(var S in w);return w}function checkiPadPro(){return!!isIOS&&(trustAppMobile?void 0!=appleModel[device.model]&&/ipad pro/i.test(appleModel[device.model]):window.devicePixelRatio>1&&1366==screenW&&1024==screenH)}function checkiPadProBig(){return!!isIOS&&(trustAppMobile?void 0!=appleModel[device.model]&&/ipad pro/i.test(appleModel[device.model])&&!/9,7/i.test(appleModel[device.model]):window.devicePixelRatio>1&&1366==screenW&&1024==screenH)}var appleModel={};function initRulesCSS(){var t="";t+='#sp-select .icon .img { background-image: url("'+assetName("img/switch-bt.png")+'"); }',t+='#sp-select .icon .txt { background-image: url("'+assetName("img/switch-bt.png")+'"); }',pageApp&&(t+=`\n\t\t\t:root {\n\t\t\t\t--colBck : ${app.colBck};\n\t\t\t\t--col0 : ${app.col0};\n\t\t\t\t--col1 : ${app.col1};\n\t\t\t\t--col2 : ${app.col2};\n\t\t\t\t--col3 : ${app.col3};\n\t\t\t\t--col4 : ${app.col4};\n\t\t\t}\n\n\t\t\t#game { \n\t\t\t\tbackground-image: url('${assetName(app.folder+"img/game-bck.jpg")}');\n\t\t\t}\n\t\t\t`),appBrowser&&(t+=`.bt-store .bck{ background-image: url(${domainOnline}img/bt-store-all-${currentLanguage.split("-")[0]}.png); }`);var e=document.head||document.getElementsByTagName("head")[0],o=document.createElement("style");e.appendChild(o),o.type="text/css",o.appendChild(document.createTextNode(t))}function BoxDialog(t){var e=this,o=$(t);function i(t){t.preventDefault(),stopProp(t),$(t.target).addClass("active");var e=!0;void 0!==t.data.func&&(t.data.func===n&&(e=!1),t.data.func()),e&&n()}function n(){e.neverClose||e.close()}return this.$div=o,this.$bck=o.find(".bac"),this.$scale=o.find(".scale"),this.$box=o.find(".box"),this.$pop=o.find(".pop"),this.$pop.$title=o.find(".title"),this.$pop.$text=o.find(".text"),this.$pop.$content=o.find(".content"),this.opened=!1,this.neverClose=!1,this.isOpen=function(){return e.opened},this.open=function(t,s,a,u,r,c,p){e.isOpen()&&(removeInArray("popup-dialog",focusHistory),deleteFocus(),e.killall()),o.on(evtPress,stopProp),e.opened=!0,e.neverClose=!isnull(c)&&c,t=isnull(t)?"Lorem ipsum dolor sit amet, consectetur adipisicing elit, sed do eiusmod":t,s=isnull(s)?"Info":s,a=isnull(a)?["Close"]:a,u=isnull(u)?[n]:u,r=!isnull(r)&&r,notnull(p)&&o.attr("data-name",p),o.addClass("show"),e.clean(),e.$pop.$title.html(s),e.$pop.$text.html(t);for(var l=0,d=a.length;l<d;l++){u[l];var f=a[l];e.$pop.$content.append('<div class="bt-mini light" id="bt-mini'+l+'"><div class="txt">'+f+'</div><div class="hitzone"></div></div>'),e.$pop.$content.find("#bt-mini"+l).off().on(evtClick,{func:u[l]},i)}r&&o.css({"z-index":"9999"}),e.fadeInBck(),e.$box.removeClass("open close").addClass("open"),createFocus("popup-dialog")},this.close=function(t){notnull(t)&&t.preventDefault(),e.fadeOutBck(),e.$box.removeClass("open close").addClass("close").one(animationEnd,function(t){$(t.target).removeClass("close"),o.removeClass("show"),o.removeAttr("data-name"),o.off(),e.clean(),e.opened=!1,removeInArray("popup-dialog",focusHistory),createFocus(focusHistory[focusHistory.length-1])})},this.killall=function(){removeInArray("popup-dialog",focusHistory),o.off(),o.removeAttr("data-name"),o.removeClass("show"),e.clean(),e.$box.removeClass("open close"),resetAnimationCSS(e.$box[0]),e.$bck.removeClass("animateFadeIn animateFadeOut"),resetAnimationCSS(e.$bck[0]),e.opened=!1},this.fadeInBck=function(t){t?e.$bck.addClass("mini"):e.$bck.removeClass("mini"),e.$bck.addClass("animateFadeIn")},this.fadeOutBck=function(){e.$bck.addClass("animateFadeOut").one(animationEnd,function(t){$(t.target).removeClass("animateFadeIn animateFadeOut")})},this.clean=function(){e.$pop.$content.find(".bt-mini").off(),e.$pop.$content.empty(),e.$pop.$title.empty(),e.$pop.$text.empty()},this}function Popup(t){var e,o=this,i=$(t),n=i.find(".bac"),s=i.find(".box"),a=i.find("span.icon"),u=i.find(".container"),r=i.find(".box-tab .tab").length>0,c=!0,p=!0;function l(){c=!0,n.removeClass("animateFadeIn animateFadeOut"),o.closeComplete()}function d(t){p=!0,s.removeClass("slideUp slideDown").get(0).offsetHeight,e.onBoxCloseEnd(),o.closeComplete(),tryfunc(t)}function f(t){notnull(o.onCloseTab)&&o.onCloseTab(),i.find(".tab.active").removeClass("active"),i.find(".pop.active").removeClass("active");var e=$(this),n=i.find(".pop#"+e.attr("id").replace("tab-","pop-"));e.addClass("active"),n.addClass("active"),createFocus(n.attr("id"))}return this.$popup=i,this.$icon=a,this.objCustom=e,this.open=function(t){notnull(e)&&t.name==e.name||(i.hasClass("show")||i.addClass("show"),n.hasClass("animateFadeIn")||o.showBck(),s.hasClass("slideUp")?o.hideBox(function(){o.open(t)}):(o.custom(t),o.showBox()))},this.close=function(t){o.hideBck(t),o.hideBox(null,t)},this.closeComplete=function(){c&&p&&(o.reinit(),tryfunc(e.onCloseComplete),e=null)},this.reinit=function(){e.static||u.empty(),i.removeClass("show mini middle info action action-back no-action"),i.removeAttr("data-name"),n.removeClass("animateFadeIn animateFadeOut"),s.removeClass("slideUp slideDown").get(0).offsetHeight},this.custom=function(t){e={static:t.static||!1,bodyclose:t.bodyclose||!1,bckclose:t.bckclose||!1,name:t.name||"no-name",icntype:t.icntype||"",bcksize:t.bcksize||"",content:t.content||"",onBoxOpenStart:t.onBoxOpenStart||nada,onBoxOpenEnd:t.onBoxOpenEnd||nada,onBoxCloseStart:t.onBoxCloseStart||nada,onBoxCloseEnd:t.onBoxCloseEnd||nada,onCloseComplete:t.onCloseComplete||nada},i.removeClass("mini middle info action action-back no-action"),i.addClass(e.bcksize),i.attr("data-name",e.name),""!=e.icntype&&(i.addClass(e.icntype),a.find("svg use").attr("xlink:href","#ic-"+("action"==e.icntype?"close":"action-back"==e.icntype?"navl":"info"))),e.static||u.html(e.content)},this.refresh=function(){notnull(e)&&notnull(e.content)&&u.html(e.content)},this.showBck=function(){c=!1,n.addClass("animateFadeIn").one(animationEnd,function(){})},this.hideBck=function(t){!0===t?l():n.addClass("animateFadeOut").one(animationEnd,function(){l()})},this.showBox=function(){p=!1,e.onBoxOpenStart(),r&&(i.find(".box-tab .tab").first().trigger(evtClick.split(" ")[0]),deleteFocus()),s.addClass("slideUp").one(animationEnd,function(){e.bodyclose&&$body.on(evtClick,o.clickBck),e.bckclose&&n.on(evtClick,o.close),e.onBoxOpenEnd()})},this.hideBox=function(t,i){e.bodyclose&&$body.off(evtClick,o.clickBck),e.bckclose&&n.off(evtClick,o.close),e.onBoxCloseStart(),!0===i?d(t):s.addClass("slideDown").one(animationEnd,function(){d(t)})},this.clickBck=function(e){if(e.preventDefault(),$(e.target).closest(t+" .box").length>0);else if(r){var i=notnull((e=~e.type.indexOf("touch")?e.originalEvent:e).targetTouches)?e.targetTouches[0]:e;Math.round(i.pageY)>100*stageScale&&o.close()}else o.close()},this.isOpen=function(){return i.hasClass("show")},this.getName=function(){return notnull(e)&&notnull(e.name)?e.name:""},r&&i.find(".box-tab .tab").each(function(t){$(this).on(evtClick,f)}),this}function checkIfPopupOpen(){notnull(boxPopup)&&boxPopup.isOpen()&&boxPopup.close(!0)}function boxInfoCustom(){var t=Math.floor(3*screenW/templateW);t=t<0?1:t;var e=boxInfo.$popup.find("#pop-tuto .slideshow");return e.$box=boxInfo.$popup.find("#pop-tuto .slideshow .img-box"),e.$btL=boxInfo.$popup.find("#pop-tuto .bt").first(),e.$btR=boxInfo.$popup.find("#pop-tuto .bt").last(),e.init=function(){var e=this,o=0,i=0,n=0,s=0,a=this.find(".overflow-box").width(),u=this.find("img").length;this.onPress=function(t){$body.off(evtPressEnd,e.onRelease),e.$box.off(evtMove,e.onMove),(t=~t.type.indexOf("touch")?t.originalEvent:t).preventDefault();var i=notnull(t.targetTouches)?t.targetTouches[0]:t;o=i.pageX,e.$box.on(evtMove,e.onMove),$body.on(evtPressEnd,e.onRelease)},this.onMove=function(n){n.preventDefault(),(n=~n.type.indexOf("touch")?n.originalEvent:n).preventDefault();var a=notnull(n.targetTouches)?n.targetTouches[0]:n;i=-1*Math.round(o-a.pageX),e.$box.css({transform:"translateX("+(s+1.6*i/t)+"px)"})},this.onRelease=function(t){t.preventDefault(),$body.off(evtPressEnd,e.onRelease),e.$box.off(evtMove,e.onMove),i<-100?n!=u-1?e.slide("left"):e.slide():i>100&&0!==n?e.slide("right"):e.slide(),o=0,i=0},this.slide=function(t){$body.off(evtPressEnd,e.onRelease),e.$box.off(evtMove,e.onMove),e.$box.addClass("slide"),"left"===t?n++:"right"===t&&n--,s=-a*n,e.$box.css({transform:"translateX("+String(s)+"px)"})},this.clickLeft=function(t){t.preventDefault(),0!==n&&e.slide("right")},this.clickRight=function(t){t.preventDefault(),n!=u-1&&e.slide("left")},this.reinit=function(){n>0&&(o=i=n=s=0,e.slide())},e.$box.on(evtPress,e.onPress),this.$btL.on(evtClick,this.clickLeft),this.$btR.on(evtClick,this.clickRight)},e.init(),e}function initPopupIndexApp(){(boxInfo=new Popup(".box-popup#pop-info")).$slide=boxInfoCustom(),boxInfo.onCloseTab=boxInfo.$slide.reinit,boxParam=new Popup(".box-popup#pop-param"),$("#pop-language .box-lang .bt-mini").on(evtClick,function(t){t.preventDefault(),preventAction(function(){clickBtLang(t)})}),$("#pop-follow .bt.facebook").on("click",function(t){t.preventDefault(),redirectTo("facebook")}),$("#pop-follow .bt.twitter").on("click",function(t){t.preventDefault(),redirectTo("twitter")}),$("#pop-follow .bt.instagram").on("click",function(t){t.preventDefault(),redirectTo("instagram")}),$("#pop-follow .bt.youtube").on("click",function(t){t.preventDefault(),redirectTo("youtube")}),$("#pop-follow .bt.tumblr").on("click",function(t){t.preventDefault(),redirectTo("tumblr")}),$("#pop-follow #img-shop").on("click",function(t){t.preventDefault(),redirectTo("shop-all")}),$("#pop-credit #bt-feedback").on("click",function(t){t.preventDefault(),preventAction(sendFeedback)}),$("#pop-credit #bt-rating").on("click",function(t){t.preventDefault();var e=isIOS||appDesktop&&isOSX?build.storeRateURL:build.storeURL;preventAction(function(){openURL(e)})}),$("#pop-credit #bt-faq").on("click",function(t){t.preventDefault(),redirectTo("faq")}),$("#pop-credit #bt-privacy").on("click",function(t){t.preventDefault(),showPP()}),appBrowserExpo&&$("#pop-credit .container").append("www.incredibox.com")}function showPP(t){}function hidePP(){}function refusePP(){}function acceptPP(t){}function dialogGetApp(t,e){notnull(t)&&t.preventDefault(),appBrowserDemo?popupGetApp(e):appBrowser?popupGetAppBrowser(e):boxDialog.open("To access this feature you have to download the Incredibox app. Let's go? &#128273;","&#128274; Locked",[STR("bt.sure"),STR("bt.later")],[],!0)}function popupGetApp(t){var e=!0===t?"action-back":"action",o="<div class='bt bt-long' id='bt-getapp'><div class='bck'><svg class='icn-svg'><use xlink:href='#ic-download'></use></svg><div class='txt'>Get app</div></div><div class='hitzone'></div></div>",i="store";o=isIOS?"<div class='bt-store' id='bt-getapp'><div class='bck appstore'></div></div>":o,i=isIOS?"appstore":i,o=isAndroid?"<div class='bt-store' id='bt-getapp'><div class='bck playstore'></div></div>":o,i=isAndroid?"playstore":i,boxPopup.open({name:"get-full-app",icntype:e,content:`\n\t\t\t<div class='title'>Feature locked</div>\n\t\t\t<div class='text'>\n\t\t\t\tWant to access all app's features?<br>\n\t\t\t\tEasy, just download Incredibox!\n\t\t\t\t${o}\n\t\t\t\t<div class='mini'>No ads, many musical style, record, share, download your mixes... and many more &#129321;</div>\n\t\t\t</div>`,onBoxOpenEnd:function(){!0===t?boxPopup.$icon.on(evtClick,popupRecok):boxPopup.$icon.on(evtClick,boxPopup.close),boxPopup.$popup.find("#bt-getapp").on("click",function(t){t.preventDefault(),redirectTo(i)})},onBoxCloseStart:function(){boxPopup.$icon.off(),boxPopup.$popup.find("#bt-getapp").off()}})}function popupGetAppBrowser(t){var e=!0===t?"action-back":"action",o="App exclusivity",i="This feature is only available in the Incredibox App.<br>Choose your store below and access the full experience!",n="More info",s=void 0!=getParameterByName("lang")&&"en"!=getParameterByName("lang")?getParameterByName("lang")+"/":"",a=domainOnline+s+"app";isIframe&&void 0!=window.top.i18n&&(o=window.top.i18n.app_exclusivity,i=window.top.i18n.feature_only_inapp+"<br>"+window.top.i18n.access_full_xp,n=window.top.i18n.bt_more_info),boxPopup.open({name:"get-full-app-browser",icntype:e,content:`\n\t\t\t<div class='title'>${o} &#128521;</div>\n\t\t\t<div class='text'>${i}</div>\n\t\t\t<div class='box-bt-store'>\n\t\t\t\t<a href="https://apps.apple.com/app/incredibox/id1093131935" target="_blank" class="bt-store"><div class="bck appstore"></div></a>\n\t\t\t\t<a href="https://play.google.com/store/apps/details?id=com.sofarsogood.incredibox" target="_blank" class="bt-store"><div class="bck playstore"></div></a>\n\t\t\t\t<a href="https://www.amazon.fr/So-Far-Good-Incredibox/dp/B07BKZCDHT/" target="_blank" class="bt-store"><div class="bck amazonstore"></div></a>\n\t\t\t\t<a href="https://store.steampowered.com/app/1545450/Incredibox/" target="_blank" class="bt-store"><div class="bck steam"></div></a>\n\t\t\t\t<a href="https://apps.apple.com/app/id1437906083" target="_blank" class="bt-store"><div class="bck macappstore"></div></a>\n\t\t\t\t<a href="https://www.microsoft.com/fr-fr/p/incredibox/9pdjpp8scs9k?rtc=1&activetab=pivot:overviewtab" target="_blank" class="bt-store"><div class="bck windowsstore"></div></a>\n\t\t\t</div>\n\t\t\t<div class="bt-mini light bt-ic"><div class="icn-box"><svg class="icn-svg"><use xlink:href="#ic-navr"></use></svg></div><div class="txt">${n}</div><div class="hitzone"></div></div>\n\t\t\t`,onBoxOpenEnd:function(){!0===t?boxPopup.$icon.on(evtClick,popupMixSaved):boxPopup.$icon.on(evtClick,boxPopup.close),boxPopup.$popup.find(".bt-mini").on("click",function(t){t.preventDefault(),openURL(a,"_self")})},onBoxCloseStart:function(){boxPopup.$icon.off(),boxPopup.$popup.find(".bt-mini").off()}})}function popupInfo(){deleteFocus(),boxInfo.open({static:!0,bckclose:!0,name:"popup-info",onBoxOpenEnd:function(){createFocus("popup-info")},onBoxCloseStart:function(){deleteFocus(),focusHistory=[]},onBoxCloseEnd:function(){boxInfo.$slide.reinit()},onCloseComplete:function(){createFocus(pageApp?"home":"index-select")}})}function popupParam(){deleteFocus(),boxParam.open({static:!0,bckclose:!0,name:"popup-param",onBoxOpenEnd:function(){createFocus("popup-param")},onBoxCloseStart:function(){deleteFocus(),focusHistory=[]},onCloseComplete:function(){createFocus(pageApp?"home":"index-select")}})}function popupSwitch(){deleteFocus(),boxSwitch.open({static:!0,bckclose:!0,name:"popup-switch",onBoxOpenEnd:function(){createFocus("popup-switch")},onBoxCloseStart:function(){deleteFocus(),focusHistory=[]},onCloseComplete:function(){createFocus("home")}})}function popupTutoDrag(){boxPopup.open({name:"drag-and-drop",icntype:"info",bcksize:"mini",bodyclose:!0,content:`\n\t\t\t<div class='title'>${STR("pop.dragDropTitle")}</div>\n\t\t\t<div class='text'>${STR("txt.tuto1")}</div>`,onBoxCloseEnd:function(){storage.setItem("popupTutoDrag","viewed")}})}function popupDrag(){boxPopup.open({name:"drag-and-drop",icntype:"info",bcksize:"mini",bodyclose:!0,content:`\n\t\t\t<div class='title'>${STR("pop.dragDropTitle")}</div>\n\t\t\t<div class='text'>${STR("pop.dragDropText")}</div>`})}function popupShort(){boxPopup.open({name:"too-short",icntype:"info",bcksize:"mini",bodyclose:!0,content:`\n\t\t\t<div class='title'>${STR("pop.toShortTitle")}</div>\n\t\t\t<div class='text'>${STR("pop.toShortText").split("%{minimum_time}").join(app.recmintime)}</div>`})}function popupBonusPlaying(){boxPopup.open({name:"bonus-playing",icntype:"info",bcksize:"mini",bodyclose:!0,content:`\n\t\t\t<div class='title'>${STR("pop.bonusPlayingTitle")}</div>\n\t\t\t<div class='text'>${STR("pop.bonusPlayingText")}</div>`})}function popupFindPreviousBonus(){boxPopup.open({name:"find-previous-bonus",icntype:"info",bcksize:"mini",bodyclose:!0,content:`\n\t\t\t<div class='title'>${STR("pop.bonusFindPreviousTitle")}</div>\n\t\t\t<div class='text'>${STR("pop.bonusFindPreviousText")}</div>`})}function popupBonusUnlocked(t){if(!modeReplay&&!modeRandom||t){var e="v"+appVersion+"-popup-bonus-unlock";(isnull(storage.getItem(e))||t)&&(storage.setItem(e,"ok"),boxPopup.open({name:"bonus-unlocked",bcksize:"middle",content:function(){var t=`\n\t\t\t\t\t\t<div class='popimg'></div>\n\t\t\t\t\t\t<div class='title'>${STR("pop.bonusUnlockTitle")}</div>\n\t\t\t\t\t\t<div class='text'>${STR("pop.bonusUnlockText")}</div>`;return isMouseDevice&&(t+=`\n\t\t\t\t\t\t\t<div class='content'>\n\t\t\t\t\t\t\t\t<div class='bt-mini light'><div class='txt'>${STR("bt.gotit")}</div><div class='hitzone'></div></div>\n\t\t\t\t\t\t\t</div>`),t},onBoxOpenStart:function(){boxPopup.$popup.addClass("pop-bonus-unlock"),boxPopup.$popup.find(".pop").append("<div id='pointe'></div>"),calcPointePosX(1)},onBoxOpenEnd:function(){isMouseDevice?boxPopup.$popup.find(".bt-mini").on(evtClick,function(t){t.preventDefault(),boxPopup.close()}):$body.on(evtClick,boxPopup.clickBck)},onBoxCloseStart:function(){isMouseDevice?boxPopup.$popup.find(".bt-mini").off():$body.off(evtClick,boxPopup.clickBck)},onBoxCloseEnd:function(){boxPopup.$popup.removeClass("pop-bonus-unlock"),boxPopup.$popup.find("#pointe").remove()}}))}}function popupBonusFindNext(t){if(!modeReplay&&!modeRandom||t){var e="v"+appVersion+"-popup-bonus-next";(isnull(storage.getItem(e))||t)&&(storage.setItem(e,"ok"),isToolbarOpen&&closeTool(),boxPopup.open({name:"find-next-bonus",bcksize:"middle",content:function(){var t=`\n\t\t\t\t\t\t<div class='title'>${STR("pop.bonusFindNextTitle")}</div>\n\t\t\t\t\t\t<div class='text'>${STR("pop.bonusFindNextText")}</div>`;return isMouseDevice&&(t+=`\n\t\t\t\t\t\t<div class='content'>\n\t\t\t\t\t\t\t<div class='bt-mini light'><div class='txt'>${STR("bt.gotit")}</div><div class='hitzone'></div></div>\n\t\t\t\t\t\t</div>`),t},onBoxOpenStart:function(){boxPopup.$popup.addClass("pop-bonus-unlock"),boxPopup.$popup.find(".pop").append("<div id='pointe'></div>"),calcPointePosX(2)},onBoxOpenEnd:function(){isMouseDevice?boxPopup.$popup.find(".bt-mini").on(evtClick,function(t){t.preventDefault(),boxPopup.close()}):$body.on(evtClick,boxPopup.clickBck)},onBoxCloseStart:function(){isMouseDevice?boxPopup.$popup.find(".bt-mini").off():$body.off(evtClick,boxPopup.clickBck)},onBoxCloseEnd:function(){boxPopup.$popup.removeClass("pop-bonus-unlock"),boxPopup.$popup.find("#pointe").remove()}}))}}function calcPointePosX(t){var e=$("#bt-bonus-"+t).offset().left-$("#box-bt2").offset().left+$("#app-incredibox").offset().left,o=$("#pop-popup .pop").offset().left,i=$("body").hasClass("ultrawide")?.8:1,n=(e-o)/stageScale/popupScale;n+=86*i*stageScale/2-32*stageScale*popupScale/2,$("#pointe").css({transform:"translateX("+Math.floor(n)+"px)"})}function popupRecok(){checkTimeRecok=getTime(),deleteFocus();var t=`\n\t\t<div class='bt bt-haut retry'><div class='bck'><svg class='icn-svg'><use xlink:href='#ic-reset'></use></svg></div><div class='txt'>${STR("bt.retry")}</div><div class='hitzone'></div></div>\n\t\t<div class='bt bt-haut replay'><div class='bck'><svg class='icn-svg'><use xlink:href='#ic-eye'></use></svg></div><div class='txt'>${STR("bt.replay")}</div><div class='hitzone'></div></div>\n\t\t<div class='bt bt-haut save'><div class='bck'><svg class='icn-svg'><use xlink:href='#ic-edit'></use></svg></div><div class='txt'>${STR("bt.save")}</div><div class='hitzone'></div></div>\n\t`;appBrowserDemo&&(t=`\n\t\t\t<div class='bt bt-haut replay'><div class='bck'><svg class='icn-svg'><use xlink:href='#ic-eye'></use></svg></div><div class='txt'>${STR("bt.replay")}</div><div class='hitzone'></div></div>\n\t\t\t<div class='bt bt-haut share'><div class='bck'><svg class='icn-svg'><use xlink:href='#ic-share'></use></svg></div><div class='txt'>${STR("bt.share")}</div><div class='hitzone'></div></div>\n\t\t\t<div class='bt bt-haut download'><div class='bck'><svg class='icn-svg'><use xlink:href='#ic-download'></use></svg></div><div class='txt'>Get MP3</div><div class='hitzone'></div></div>\n\t\t`),boxPopup.open({name:"record-complete",icntype:"action",content:`\n\t\t\t<div class='title'>${STR("pop.recOkTitle")}</div>\n\t\t\t<div class='content'>\n\t\t\t\t<div class='box-bt-haut'>\n\t\t\t\t\t${t}\n\t\t\t\t</div>\t\n\t\t\t</div>`,onBoxOpenEnd:function(){boxPopup.$icon.on(evtClick,boxPopup.close),boxPopup.$popup.find(".bt.replay").on(evtClick,function(t){t.preventDefault(),preventAction(clickReplayMix)}),appBrowserDemo?(boxPopup.$popup.find(".bt.share").on(evtClick,function(t){t.preventDefault(),preventAction(function(){popupGetApp(!0)})}),boxPopup.$popup.find(".bt.download").on(evtClick,function(t){t.preventDefault(),preventAction(function(){popupGetApp(!0)})})):(boxPopup.$popup.find(".bt.retry").on(evtClick,function(t){t.preventDefault(),preventAction(clickRetryMix)}),boxPopup.$popup.find(".bt.save").on(evtClick,function(t){t.preventDefault(),preventAction(clickSaveMix)})),createFocus("popup-record-complete"),unlock()},onBoxCloseStart:function(){deleteFocus(),boxPopup.$icon.off(),boxPopup.$popup.find(".bt").off()},onBoxCloseEnd:function(){boxPopup.$icon.off(),boxPopup.$popup.find(".bt").off()},onCloseComplete:function(){removeInArray("popup-record-complete",focusHistory),modeReplay||createFocus("toolbar")}})}var checkTimeRecok=0;function canIclickRecok(){return getTime()-checkTimeRecok>600}function clickRetryMix(){canIclickRecok()&&(appBrowserDemo&&withAdBreak&&callAd("next","retry-mix"),boxPopup.close(),TweenMax.delayedCall(.2,startRecordMode))}function clickReplayMix(){canIclickRecok()&&(boxPopup.close(),startReplayMode(),saveGA("mix","replay"))}function clickSaveMix(){popupForm()}function popupForm(){boxPopup.open({name:"save-form",icntype:"action-back",content:function(){var t=`\n\t\t\t<div class='title'>${STR("pop.formTitle")}</div>\n\t\t\t<div class='content'>\n\t\t\t\t<form action='javascript:clickBtValidFormMix()' method='post' target='_self' autocomplete='off'>\n\t\t\t\t\t<div class='formzone'>\n\t\t\t\t\t\t<div class='formline ic-name'><div class='icn-box'><svg class='icn-svg'><use xlink:href='#ic-user-mini'></use></svg></div><input type='text' id='input-name' placeholder='${STR("txt.inputName")}' value='${user.djname}' maxlength='26' autocorrect='off' spellcheck='false'/></div>\n\t\t\t\t\t\t<div class='formline ic-title'><div class='icn-box'><svg class='icn-svg'><use xlink:href='#ic-note-mini'></use></svg></div><input type='text' id='input-title' placeholder='${STR("txt.inputTitle")}' value='' maxlength='26' autocorrect='off' spellcheck='false'/></div>\n\t\t\t\t\t\t<div class='formline ic-dedi'><div class='icn-box'><svg class='icn-svg'><use xlink:href='#ic-like-mini'></use></svg></div><input type='text' id='input-dedi' placeholder='${STR("txt.dedicatedTo").split("%{name}").join("...")}' value='' maxlength='26' autocorrect='off' spellcheck='false'/></div>`;return appBrowser||(t+=`<div class='formline ic-private'>\n\t\t\t\t\t\t\t<div class='icn-box'><svg class='icn-svg'><use xlink:href='#ic-view-mini'></use></svg></div>\n\t\t\t\t\t\t\t<div class='bt-onofftext active'>\n\t\t\t\t\t\t\t\t<div class='slider'></div>\n\t\t\t\t\t\t\t\t<div class='txtbox'>\n\t\t\t\t\t\t\t\t\t<div class='label'>${STR("bt.private")}</div>\n\t\t\t\t\t\t\t\t\t<div class='label'>${STR("bt.public")}</div>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>`),t+="</div>\n\t\t\t\t\t<div class='btzone'>\n\t\t\t\t\t\t<div class='bt valid'><div class='bck'><svg class='icn-svg'><use xlink:href='#ic-check'></use></svg></div><div class='hitzone'></div></div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<input type='submit' style='visibility:hidden;position:absolute'/><div class='clear'></div>\n\t\t\t\t</form>\n\t\t\t</div>",appBrowser&&!appBrowserExpo&&(t+=`<div style='margin-top: 25px; color:#777; font-size:14px; line-height:20px;'>${STR("pop.dontUseName")} &#128521;</div>`),t},onBoxOpenEnd:function(){if(createFocus("popup-save-form"),boxPopup.$icon.on(evtClick,popupRecok),boxPopup.$popup.find(".bt.valid").on(evtClick,function(t){t.preventDefault(),preventAction(clickBtValidFormMix)}),appBrowser||appDesktop||(boxPopup.$popup.find(".formline:not(.ic-private)").on(evtPress,function(t){boxPopup.$popup.find(".formline").off(evtPress),Spinner.add($(this).find(".icn-box"))}),boxPopup.$popup.find(".formline input").on("focus",function(){boxPopup.$popup.find(".formline input").off("focus"),Spinner.reset()})),!appBrowser&&!isSafeMode()){var t=boxPopup.$popup.find(".formline.ic-private .bt-onofftext"),e=boxPopup.$popup.find(".formline.ic-private svg use");t.on(evtClick,function(o){o.preventDefault(),t.hasClass("active")?(t.removeClass("active"),e.attr("xlink:href","#ic-lock-mini")):(t.addClass("active"),e.attr("xlink:href","#ic-view-mini"))})}},onBoxCloseStart:function(){removeInArray("popup-save-form",focusHistory),deleteFocus(),boxPopup.$icon.off(),boxPopup.$popup.find(".bt").off(),boxPopup.$popup.find(".bt-onofftext").off(),boxPopup.$popup.find("input").off(),appBrowser||appDesktop||(boxPopup.$popup.find(".formline").off(),boxPopup.$popup.find(".formline input").off()),appMobile&&blurAll()}})}var formProcessing=!1,translateObj;function clickBtValidFormMix(){if(boxPopup.$popup.find(".formzone .formline input").hasClass("focused"))return!1;if(launchImmersiveMode(),!formProcessing){formProcessing=!0,lock();var t=appBrowser||isSafeMode()||!boxPopup.$popup.find(".formzone .bt-onofftext").hasClass("active"),e=boxPopup.$popup.find(".formzone #input-name"),o=boxPopup.$popup.find(".formzone #input-title"),i=boxPopup.$popup.find(".formzone #input-dedi"),n=e.val().substr(0,26),s=o.val().substr(0,26),a=i.val().substr(0,26);n=cleanInputText(n,e),s=cleanInputText(s,o),a=cleanInputText(a,i);var u=regexList.classic,r=n.replace(/ /g,""),c=s.replace(/ /g,""),p=a.replace(/ /g,"");if(u.test(r))invalidField(e);else if(u.test(c))invalidField(o);else if(u.test(p))invalidField(i);else if(""===r)invalidField(e);else if(""===c)invalidField(o);else{deleteFocus(),boxPopup.$popup.find(".formzone input").blur();var l={mymix:!0,online:!1,name:ucwords(n),title:ucwords(s),dedi:ucwords(a),app:app.version,datedb:getDateNow(),link:getUniqLink(),private:t?1:0,nbview:0,nblike:0,xml:trim(recordMix.getXML())};appBrowserExpo&&(l.dedi="Design Inspire");var d=boxPopup.$popup.find(".bt.valid");Spinner.add(d),recordMix.setData(l),localMixObject.saveMix(l),mixToShare=l,setUserInfo({djname:ucwords(n)}),delete XHRmemotime.mymix,saveGA("mix","save_local"),hasNetwork?appBrowser?saveMixDB(l,function(){f(d)},function(){boxDialog.open(STR("pop.noCoServerText"),STR("pop.noCoServerTitle"),[STR("bt.ok")]),Spinner.reset(),formProcessing=!1,unlock()}):saveMixDB(l,function(){f(d)}):appBrowser?(Spinner.reset(),formProcessing=!1,unlock(),boxDialog.open(STR("pop.noNetworkText"),STR("pop.noNetworkTitle"),[STR("bt.ok")],[])):f(d)}}function f(t){TweenMax.delayedCall(1,function(){Spinner.reset(),popupMixSaved()})}}function invalidField(t){t.addClass("invalid").one(animationEnd,function(t){$(t.target).removeClass("invalid")}),formProcessing=!1,unlock()}function keyboardOpen(t){TweenMax.set(boxPopup.$popup,{scrollTo:{y:0}}),boxPopup.$popup.addClass("keyboardOpen");var e=boxPopup.$popup.find("#input-name"),o=t.keyboardHeight,i=(screenH-o)/2,n=e.height()/2;boxPopup.$popup.find(".formline input").each(function(){var t=$(this),e=Math.round(t.position().top-i+n)/stageScale;t.focus(function(t){TweenMax.to(boxPopup.$popup,.4,{scrollTo:{y:e},ease:Quint.easeInOut})})}),e.focus()}function keyboardClose(){TweenMax.to(boxPopup.$popup,.5,{scrollTo:{y:0},ease:Quint.easeInOut,onComplete:function(){boxPopup.$popup.removeClass("keyboardOpen")}})}function blurAll(){notnull(document.activeElement)&&document.activeElement.blur(),isAndroid&&launchImmersiveMode()}function listenFocus(){var t=!1;isIOS&&(document.addEventListener("focusin",function(){t=!0}),document.addEventListener("focusout",function(){t=!1,setTimeout(function(){t||window.scrollTo(0,0)},250)}))}function popupConvertMix(){var t=$mixlist.hasClass("show")?"action":"action-back";boxPopup.open({name:"convert-mix",icntype:t,content:`\n\t\t\t<div class='title'>${STR("pop.convertMixTitle")}</div>\n\t\t\t<div class='text'>${STR("pop.convertMixText")}</div>\n\t\t\t<div class='content'>\n\t\t\t\t<div id='convert-loader-box' class='progress-box'><div class='scale'><div class='progress-bar'></div></div></div>\n\t\t\t\t<a class='bt bt-long download' id='bt-save-file'><div class='bck'><svg class='icn-svg'><use xlink:href='#ic-download'></use></svg><div class='txt'>${STR("bt.saveFile")}</div></div><div class='hitzone'></div></a>\n\t\t\t\t<div class='spinner-box spin'><svg class='icn-svg col-version'><use xlink:href='#ic-loader'></use></svg></div>\n\t\t\t</div>`,onBoxOpenEnd:function(){createFocus("popup-convert-mix"),boxPopup.$icon.on(evtClick,function(){"action"==t?boxPopup.close():popupMixSaved()}),notnull(mixToShare)&&startConvert(contextAudio,mixToShare,boxPopup.$popup.find(".content"))},onBoxCloseStart:function(){removeInArray("popup-convert-mix",focusHistory),removeInArray("popup-convert-mix-ready",focusHistory),deleteFocus(),boxPopup.$icon.off(),stopConvert()}})}function popupMixSaved(){formProcessing=!1,boxPopup.open({name:"mix-saved",icntype:"action",content:function(){var t=appBrowser?STR("pop.shareMixSaved"):STR("pop.shareMixSavedPlaylist")+"<br>"+STR("pop.shareShareTop50");t=1==mixToShare.private?t.split("<br>")[0]:t,appBrowserExpo&&(t="Your mix has been saved.<br>Now you can share it!");var e="";return(trustAppMobile||appBrowserExpo)&&(e+=`<div class='bt bt-haut link color'><div class='bck'><svg class='icn-svg'><use xlink:href='#ic-link'></use></svg></div><div class='txt'>${STR("bt.link")}</div><div class='hitzone'></div></div>`),e+=`<div class='bt bt-haut share color'><div class='bck'><svg class='icn-svg'><use xlink:href='#ic-share'></use></svg></div><div class='txt'>${STR("bt.share")}</div><div class='hitzone'></div></div>`,isComputer&&(e+=`<div class='bt bt-haut download color hoverLocked'><div class='bck'><svg class='icn-svg'><use xlink:href='#ic-download'></use></svg></div><div class='txt'>${STR("bt.exportFile")}</div><div class='ic-locked'><svg class='icn-svg'><use xlink:href='#ic-lock'></use></svg></div><div class='hitzone'></div></div>`),e+=`<div class='bt bt-haut mixlist color hoverLocked'><div class='bck'><svg class='icn-svg'><use xlink:href='#ic-mixlist'></use></svg></div><div class='txt'>${STR("bt.myMix")}</div><div class='ic-locked'><svg class='icn-svg'><use xlink:href='#ic-lock'></use></svg></div><div class='hitzone'></div></div>`,`\n\t\t\t\t<div class='title'>${STR("pop.shareTitle")}</div>\n\t\t\t\t<div class='text'>${t}</div>\n\t\t\t\t<div class='content'>\n\t\t\t\t\t<div class='box-bt-haut'>${e}</div>\n\t\t\t\t</div>`},onBoxOpenEnd:function(){createFocus("popup-mix-saved"),boxPopup.$icon.on(evtClick,boxPopup.close),(trustAppMobile||appBrowserExpo)&&boxPopup.$popup.find(".bt.link").on(evtClick,function(t){t.preventDefault();var e=$(this);preventAction(function(){clickBtCopyLink(e)})}),boxPopup.$popup.find(".bt.share").on(evtClick,function(t){t.preventDefault();var e=$(this);preventAction(function(){clickBtShareGlobal(e)})}),appBrowser?(boxPopup.$popup.find(".bt.mixlist").on(evtClick,function(t){dialogGetApp(t,!0)}),boxPopup.$popup.find(".bt.download").on(evtClick,function(t){dialogGetApp(t,!0)})):(boxPopup.$popup.find(".bt.mixlist").on(evtClick,function(t){t.preventDefault(),preventAction(clickBtGoToMixlist)}),boxPopup.$popup.find(".bt.download").on(evtClick,function(t){t.preventDefault(),preventAction(function(){socialSharingOk("download")})})),unlock()},onBoxCloseStart:function(){deleteFocus(),boxPopup.$icon.off(),boxPopup.$popup.find(".bt").off()},onCloseComplete:function(){onGame&&createFocus("toolbar"),mixToShare={}}})}function clickBtShareGlobal(t){socialSharing("global",t||$(this))}function clickBtShareMail(t){socialSharing("mail",t||$(this))}function clickBtShareFacebook(t){socialSharing("facebook",t||$(this))}function clickBtShareTwitter(t){socialSharing("twitter",t||$(this))}function clickBtShareLink(t){socialSharing("link",t||$(this))}function clickBtCopyLink(t){socialSharing("clipboard",t||$(this))}function clickBtGoToMixlist(){backToHome(function(){openPlaylist("mymix",!0,!0)})}function popupGlobalShare(){var t=$mixlist.isOpen()?"action":"action-back";boxPopup.open({name:"global-share",icntype:t,bcksize:isMixReplay?"mini":"",content:`\n\t\t\t<div class='title'>${STR("bt.share")}</div>\n\t\t\t<div class='content'>\n\t\t\t\t<div class='box-bt-haut'>\n\t\t\t\t\t<div class='bt bt-haut mail color'><div class='bck'><svg class='icn-svg'><use xlink:href='#ic-mail'></use></svg></div><div class='txt'>Mail</div><div class='hitzone'></div></div>\n\t\t\t\t\t<div class='bt bt-haut facebook color'><div class='bck'><svg class='icn-svg'><use xlink:href='#ic-facebook'></use></svg></div><div class='txt'>Facebook</div><div class='hitzone'></div></div>\n\t\t\t\t\t<div class='bt bt-haut twitter color'><div class='bck'><svg class='icn-svg'><use xlink:href='#ic-twitter'></use></svg></div><div class='txt'>Twitter</div><div class='hitzone'></div></div>\n\t\t\t\t\t<div class='bt bt-haut link color'><div class='bck'><svg class='icn-svg'><use xlink:href='#ic-link'></use></svg></div><div class='txt'>${STR("bt.link")}</div><div class='hitzone'></div></div>\n\t\t\t\t</div>\n\t\t\t</div>`,onBoxOpenEnd:function(){createFocus("popup-global-share"),boxPopup.$popup.find(".bt.mail").on(evtClick,function(t){t.preventDefault(),preventAction(function(){socialSharingOk("mail")})}),boxPopup.$popup.find(".bt.facebook").on(evtClick,function(t){t.preventDefault(),preventAction(function(){socialSharingOk("facebook")})}),boxPopup.$popup.find(".bt.twitter").on(evtClick,function(t){t.preventDefault(),preventAction(function(){socialSharingOk("twitter")})}),boxPopup.$popup.find(".bt.link").on(evtClick,function(t){t.preventDefault(),preventAction(function(){socialSharingOk("clipboard")})}),"action"==t?boxPopup.$popup.find("span.icon").on(evtClick,boxPopup.close):boxPopup.$popup.find("span.icon").on(evtClick,popupMixSaved),unlock()},onBoxCloseStart:function(){removeInArray("popup-global-share",focusHistory),deleteFocus(),boxPopup.$popup.find("span.icon").off(),boxPopup.$popup.find(".bt").off()},onBoxCloseEnd:function(){createFocus(focusHistory[focusHistory.length-1]),Spinner.reset()}})}function popupEmail(){boxPopup.open({name:"email-form",icntype:"action-back",bcksize:isMixReplay?"mini":"",content:`\n\t\t\t<div class='title'>${STR("pop.formEmailTitle")}</div>\n\t\t\t<div class='content'>\n\t\t\t\t<form action='javascript:clickBtValidFormEmail()' method='post' target='_self' autocomplete='off'>\n\t\t\t\t\t<div class='formzone'>\n\t\t\t\t \t\t<div class="formline ic-name"><div class="icn-box"><svg class="icn-svg"><use xlink:href="#ic-user-mini"></use></svg></div><input type="text" id="input-name" placeholder="${STR("txt.inputEmailSender")}" value="${notnull(user.djname)?user.djname:""}" maxlength="26" autocorrect="off" spellcheck="false"/></div>\n\t\t\t\t\t\t<div class='formline ic-email'><div class='icn-box'><svg class='icn-svg'><use xlink:href='#ic-at-mini'></use></svg></div><input type='email' id='input-email' placeholder='${STR("txt.inputEmailRecipient")}' value='' maxlength='254' autocorrect='off' spellcheck='false'/></div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class='btzone'>\n\t\t\t\t\t\t<div class='bt valid'><div class='bck'><svg class='icn-svg'><use xlink:href='#ic-check'></use></svg></div><div class='hitzone'></div></div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<input type='submit' style='visibility:hidden;position:absolute'/><div class='clear'></div>\n\t\t\t\t</form>\n\t\t\t</div>`,onBoxOpenEnd:function(){createFocus("popup-email-form"),boxPopup.$icon.on(evtClick,popupGlobalShare),boxPopup.$popup.find(".bt.valid").on(evtClick,function(t){t.preventDefault(),preventAction(clickBtValidFormEmail)})},onBoxCloseStart:function(){removeInArray("popup-email-form",focusHistory),deleteFocus(),boxPopup.$icon.off(),blurAll()},onBoxCloseEnd:function(){formProcessing=!1}})}function clickBtValidFormEmail(){if(boxPopup.$popup.find(".formzone .formline input").hasClass("focused"))return!1;var t=domainOnline+"mix/"+mixToShare.link,e=mixToShare.title,o=mixToShare.name;if(!formProcessing){formProcessing=!0,lock();var i=boxPopup.$popup.find(".formzone #input-name"),n=boxPopup.$popup.find(".formzone #input-email"),s=i.val().substr(0,26),a=n.val().substr(0,254);s=cleanInputText(s,i),a=trim(a);var u=s.split(" ").join(""),r=a.toLowerCase();if(""==u||regexList.classic.test(u))invalidField(i);else if(""!=r&&regexList.email.test(r)){boxPopup.$popup.find(".formzone input").blur(),blurAll();var c=boxPopup.$popup.find(".bt.valid");if(Spinner.add(c),hasNetwork){var p={};p.expediteur=s,p.email=a,p.type="composition",p.djName=o,p.title=e,p.link=t,p.src=appDesktop?"electron":"browser",p.lang=currentLanguage.split("-")[0],xhr("POST",domainOnline+"ph3/send-mail.php",p,function(t){"success"==t.state?(Spinner.reset(),c.addClass("success"),TweenMax.delayedCall(.6,function(){unlock(),popupGlobalShare()})):(boxDialog.open(STR("pop.shareErrorText"),STR("pop.shareErrorTitle"),[STR("bt.ok")],[function(){Spinner.reset()}]),formProcessing=!1,unlock())},function(t){formProcessing=!1,boxDialog.open(STR("pop.shareErrorText"),STR("pop.shareErrorTitle"),[STR("bt.ok")],[function(){Spinner.reset()}]),unlock()})}else formProcessing=!1,boxDialog.open(STR("pop.noNetworkText"),STR("pop.noNetworkTitle"),[STR("bt.ok")],[function(){Spinner.reset()}]),unlock()}else invalidField(n)}}function saveMixDB(_mobj,_cbk,_errorcbk){var errorcbk=_errorcbk||_cbk,data=getAppData();data.mix=_mobj,$.ajax({type:"POST",url:domainOnline+"ph3/save-mix-db.php",data:data,dataType:"json",crossdomain:!0,success:function(_obj){void 0!=_obj.eval&&eval(_obj.eval),"success"==_obj.state?(_mobj.online=!0,_mobj.link=_obj.link,_mobj.id=_obj.id,_mobj.datedb=_obj.datedb,localMixObject.saveMix(_mobj),delete XHRmemotime.latest,_cbk(),saveGA("mix","save_db")):(errorcbk(),saveGA("mix","save_db_failed"))},error:function(t){errorcbk(),saveGA("mix","save_db_error")}})}function socialSharing(t,e){if(lock(),deleteFocus(),Spinner.add(e),hasNetwork)!0===mixToShare.mymix?mixToShare.online?socialSharingOk(t):saveMixDB(mixToShare,function(){socialSharingOk(t),$(".boxline .line[data-key='mix-"+mixToShare.link+"']").removeClass("isoffline")},function(){boxDialog.open(STR("pop.noCoServerText"),STR("pop.noCoServerTitle"),[STR("bt.ok")],[]),Spinner.reset(),unlock()}):socialSharingOk(t);else{var o=$mixlist.hasClass("show")?STR("pop.noCoShareText"):STR("pop.noCoShareText")+" "+STR("pop.noCoShareText2");boxDialog.open(o,STR("pop.noNetworkTitle"),[STR("bt.ok")],[function(){Spinner.reset()}]),unlock()}}function socialSharingOk(t,e){var o=mixToShare.name,i=mixToShare.title,n=(mixToShare.dedi,mixToShare.datedb,domainOnline+"mix/"+mixToShare.link),s=domainOnline+"img/share/share-v"+app.version+"-en@2x.png",a=domainOnline+"img/share/share-v"+app.version+"-en.png",u=STR("pop.shareSubject"),r=STR("pop.sharePresentMix").split("%{name}").join(o).split("%{title}").join(i),c=STR("pop.shareTextLike"),p=STR("pop.shareTextBeCool"),l=r+"\n"+n+"\n\n"+c+"\n\n---------------------------\n\nDownload the app: https://www.incredibox.com/info/store",d="#incredibox",f=p+" #incredibox",v=r+" "+p+" #incredibox";if(appBrowserExpo&&(d+=" #DesignInspire #hktdc",f+=" #DesignInspire #hktdc",v+=" #DesignInspire #hktdc"),"global"!=t&&Spinner.reset(),"download"==t){if(appDesktop&&hasWorker)popupConvertMix();else openURL(domainOnline+"file/"+mixToShare.link);unlock(),saveGA("mix","export_mp3")}else saveGA("mix","share",t);switch(t){case"mail":trustAppMobile&&window.plugins.socialsharing.shareViaEmail(l,u,null,null,null,[a],h,b),isComputer&&popupEmail();break;case"facebook":trustAppMobile&&window.plugins.socialsharing.shareViaFacebook(d,s,n,h,b),appBrowser&&windowPopup("https://www.facebook.com/sharer/sharer.php?u="+encodeURIComponent(n),560,350,!0),appDesktop&&openURL("https://www.facebook.com/sharer/sharer.php?u="+encodeURIComponent(n));break;case"twitter":trustAppMobile&&window.plugins.socialsharing.shareViaTwitter(f,s,n,h,b),appBrowser&&windowPopup("https://twitter.com/intent/tweet?text="+encodeURIComponent(f)+"&url="+encodeURIComponent(n)+"&hashtags=musicApp,beatbox,pumpItUp&related=incredibox_%3AThe%20Incredibox%20official%20Twitter%20account!",560,350,!0),appDesktop&&openURL("https://twitter.com/intent/tweet?text="+encodeURIComponent(f)+"&url="+encodeURIComponent(n)+"&hashtags=musicApp,beatbox,pumpItUp&related=incredibox_%3AThe%20Incredibox%20official%20Twitter%20account!");break;case"clipboard":appDesktop?copyToClipboardElectron(n,m):trustAppMobile?cordova.plugins.clipboard.copy(n,m,function(){boxDialog.open(STR("pop.shareErrorText"),STR("pop.shareErrorTitle"),[STR("bt.ok")],[]),b()}):(appBrowser||isComputer)&&(copyToClipboard(n),m(n));break;case"global":trustAppMobile?window.plugins.socialsharing.share(v,u,s,n,h,b):isComputer&&(popupGlobalShare(),Spinner.reset())}function m(t){if(appBrowser){var e="<div class='selectarea'>"+t.replace("https://www.","")+"</div>",o=isIOS?"":STR("pop.shareClipboard");boxDialog.open(e+o,STR("bt.link"),[STR("bt.ok")],[],!1,!1,"dialog-clipboard")}else boxDialog.open(STR("pop.shareClipboard"),STR("pop.infoTitle"),[STR("bt.ok")],[],!1,!1,"dialog-clipboard");h(),unlock()}function h(){Spinner.reset(),unlock()}function b(){Spinner.reset(),unlock()}}function copyToClipboardElectron(t,e){_electron.clipboard.writeText(t),e()}function sendFeedback(){saveGA("share","click_feedback");var t="feedback@incredibox.com",e="App feedback ("+machine.deviceModel+")",o="<br><br>----------";if(o+="<br>From : "+ucwords(build.platform)+" - "+("undefined"!=typeof app?app.name+" - v"+app.version:"index"),o+="<br>Version : "+build.version,o+="<br>DJ Name : "+user.djname,o+="<br>Guid : "+user.guid,o+="<br>Lang : "+user.lang+" ("+currentLanguage+")",o+="<br>Machine : "+machine.uuid+(trustAppMobile?" - "+device.serial:""),o+="<br>Device : "+machine.deviceModel+" - "+screen.width+"x"+screen.height+" - "+(window.devicePixelRatio||1),o+="<br>System : "+machine.osName+" - "+machine.osVersion+(appDesktop?" - "+_electron.os.arch():""),o+="<br>Store : "+build.store,o+="<br>WV : "+machine.browserFullVersion,o+="<br>Anime - Asset  : "+(isAnimeHD?"HD":"LD")+" - "+(isAssetHD?"HD":"LD"),o+="<br>Evt : "+evtClick,o+="<br>SpRate : "+(notnull(contextAudio)?contextAudio.sampleRate+(notnull(contextAudio.baseLatency)?" - "+contextAudio.baseLatency:""):""),trustAppMobile)o+="<br>----------",o+="<br>App.device : "+(appleModel[device.model]||device.model)+" - "+device.manufacturer,o+="<br>App.system : "+device.platform+" - "+device.version,window.plugins.socialsharing.shareViaEmail("<br><br><br><i>"+o+"</i>",e,t,null,null,[]);else{o=o.replace(/<br>/g,"\r\n");var i="mailto:"+t+"?subject="+e+"&body="+encodeURIComponent(o);appDesktop?_electron.shell.openExternal(i):window.location.href=i}}var defaultLanguage=appSQ?"fr":appCN?"zh-CN":"en-US",currentLanguage=defaultLanguage,systemLanguage,languageListe={"en-US":"English",ru:"Русский",uk:"Український"};function checkLanguageCode(t){var e=t.toLowerCase();return e.indexOf("en-")>-1?"en-US":e.indexOf("pt-")>-1?"pt-BR":e.indexOf("fr-")>-1?"fr":e.indexOf("es-")>-1?"es":e.indexOf("it-")>-1?"it":e.indexOf("de-")>-1?"de":e.indexOf("cn")>-1?"zh-CN":"zh-hant"==e||"zh-hk"==e||"zh-tw"==e?"zh-TW":"zh-hans"==e||"zh-cn"==e?"zh-CN":"en"==e?"en-US":"pt"==e?"pt-BR":"zh"==e?"zh-CN":"hi"==e?"hi-IN":"bn"==e?"bn-IN":"ta"==e?"ta-IN":"te"==e?"te-IN":"nb"==e||"nn"==e?"no":t}function createBtLanguage(){var t="";for(var e in languageListe){t+='<div class="bt-mini soft" id="bt-lang-'+e+'"><div class="txt">'+languageListe[e]+'</div><div class="hitzone"></div></div>'}$("#pop-language .box-lang").append(t)}function debugLanguage(){document.addEventListener("keyup",function(t){var e=t.key.toLowerCase();if("a"==e||"z"==e){var o=Object.keys(languageListe).indexOf(currentLanguage);"a"==e?o--:"z"==e&&o++;var i=Object.keys(languageListe);o>i.length-1&&(o=0),o<0&&(o=i.length-1),loadLanguage(changeDomTxt,i[o])}})}function changeDomTxt(){var t=translateObj.trad;if($("#pop-info .tab#tab-tuto").html(t.bt.tuto),$("#pop-info .tuto1 .txt").html(t.txt.tuto1),$("#pop-info .tuto2 .txt").html(t.txt.tuto2),$("#pop-info .tuto3 .txt").html(t.txt.tuto3),$("#pop-info .tuto4 .txt").html(t.txt.tuto4),$("#pop-info .tuto5 .txt").html(t.txt.tuto5),$("#pop-info .tab#tab-credit").html(t.bt.credit),$("#pop-info #pop-credit #copy").html(t.txt.copyright),$("#pop-info #pop-credit #team").html("<div class='box-team'>Allan Durand<br>Romain Delambily<br>Incredible Polo</div><div class='box-team'>"+t.txt.team+"</div>"),$("#pop-info #pop-credit .title").html(t.txt.stayTuned),$("#pop-info #pop-credit #bt-feedback .txt").html(t.bt.feedback),$("#pop-info #pop-credit #bt-rating .txt").html(t.bt.rate),$("#pop-info #pop-credit #bt-privacy .txt").html(t.bt.privacy),$("#pop-info .tab#tab-follow").html(t.bt.follow),$("#pop-info #pop-follow .title#git").html(t.bt.git),$("#pop-info #pop-follow .title#shop").html(t.txt.visitShop),$("#pop-param .tab#tab-language").html(t.txt.language),$("#pop-param .tab#tab-setting").html(t.bt.param),$("#pop-param #pop-setting #param-dark .label").html(t.txt.modeDark),$("#pop-param #pop-setting #param-safe .label").html(t.txt.modeSafe),$("#pop-param #pop-setting #param-reset .label").html(t.txt.resetBonus),$("#pop-param #pop-setting #param-reset .bt-mini .txt").html(t.bt.reset),$("#pop-param #pop-setting #param-recover .label").html(t.txt.recoverAllMix),$("#pop-param #pop-setting #param-recover .bt-mini .txt").html(t.bt.recover),$("#pp-box #bt-ppaccept .txt").html(t.bt.accept),$("#pp-box #bt-pprefuse .txt").html(t.bt.refuse),pageApp){if($("#home .bt#home-bt-switch .txt").html(t.bt.version),$("#home .bt#home-bt-list .txt").html(appBrowser?t.bt.myMix:t.bt.mixList),$("#mixlist .tab#tab-mixlist .txt").html(t.bt.myMix),$("#mixlist .tab#tab-top50 .txt").html(t.bt.top50),$("#mixlist .tab#tab-latest .txt").html(t.bt.latest),$("#mixlist .tab#tab-search .txt").html(t.bt.search),$("#mixlist #searchbox #input-search").attr("placeholder",t.txt.inputSearch),$("#mixlist #searchbox #input-search").val(""),lastSearch="",cleanListSearch(),$("#mixlist .tab-filter #bt-name .txt").html(t.bt.djname),$("#mixlist .tab-filter #bt-title .txt").html(t.bt.mixtitle),$("#mixlist .tab-filter #bt-dedi .txt").html(t.txt.dedicatedTo.split("%{name}").join("")),$("#mixlist .tab-filter #bt-day .txt").html(t.bt.day),$("#mixlist .tab-filter #bt-week .txt").html(t.bt.week),$("#mixlist .tab-filter #bt-month .txt").html(t.bt.month),$("#mixlist .tab-filter #bt-year .txt").html(t.bt.year),$("#mixlist .scroll:not(#list-mymix) .infoListmix").html(t.txt.top50Info),totalNumberMix>0?$("#mixlist #list-latest .boxinfo").html(t.txt.latestMixInfo.replace("%{mix_total}",numberSpaced(totalNumberMix)).replace("%{version_name}",app.name)):$("#mixlist #list-latest .boxinfo").html(t.txt.latestMixInfo.split("<br>")[0]),$("#mixlist #list-day .boxinfo").html(t.txt.top50Info),$("#mixlist #list-week .boxinfo").html(t.txt.top50Info),$("#mixlist #list-month .boxinfo").html(t.txt.top50Info),$("#mixlist #list-year .boxinfo").html(t.txt.top50Info),$("#mixlist .box-info .offline .txt").html(t.txt.offline),$("#watch-info #bt-save .txt").html(t.bt.save),$("#watch-info .offline .txt").html(t.txt.offline),notnull(localMixObject)){var e=0==localMixObject.getMixlist().length?STR("txt.mixlistEmpty"):STR("txt.mixlistInfo");$("#list-mymix .boxinfo",$poplist).html(e)}$("#watch-info .date, .box-info .date").each(function(){if($(this).attr("data-date")){var t=$(this).attr("data-date");$(this).html(getStringDate(t))}}),$("#pop-news .text").html(t.txt.prezAlbum),$("#pop-news #bt-album .txt").html(t.bt.listenAlbum),$("#pop-switch .title").html(t.txt.enjoyVersion),$("#game #box-bt1 #bt-stop .txt").html(t.bt.menuRestart),$("#game #box-bt1 #bt-random .txt").html(t.bt.menuRandom),$("#game #box-bt1 #bt-record .txt").html(t.bt.menuRecord)}else $("#page-splash #sp-baseline").html(STR("txt.baseline")),$("#page-splash #sp-text").html(STR("txt.useHeadphones")),$("#page-splash #sp-text").html(STR("txt.selectVersion"));notnull(boxPopup)&&boxPopup.isOpen()&&boxPopup.refresh()}function loadLanguage(t,e){var o=notnull(e)&&notnull(languageListe[e])?e:notnull(user.lang)&&""!=user.lang?user.lang:""!=machine.language?machine.language:defaultLanguage;appBrowser&&(o=null!=getParameterByName("lang")?getParameterByName("lang"):defaultLanguage),o=checkLanguageCode(o),isnull(languageListe[o])&&(o=defaultLanguage);$("#pop-language .box-lang .bt-mini#bt-lang-"+o).addClass("active");notnull(translateObj)&&$("body").removeClass("lang-"+currentLanguage);var i=new XMLHttpRequest;function n(){return setUserInfo({lang:defaultLanguage}),boxDialog.open("Impossible to load language settings. Please reload or force to quit the app then retry.","ERROR",["Reload"],[gotoAppUrl],!0),removeFadeAll(),saveGA("language","load_failed",o),!1}i.addEventListener("load",function(){translateObj=jsonDecode(this.responseText),setUserInfo({lang:currentLanguage=o}),$("body").addClass("lang-"+currentLanguage),isnull(t)||t();saveGA("language","load_success",currentLanguage)},!1),i.addEventListener("error",n,!1),i.addEventListener("abort",n,!1),i.open("GET","./lang/"+o+".json"),i.send()}function clickBtLang(t){var e=$(t.currentTarget),o=e.attr("id").replace("bt-lang-","");e.hasClass("active")||($("#pop-language .box-lang .bt-mini").removeClass("active"),e.addClass("active"),loadLanguage(changeDomTxt,o))}function STR(t){for(var e=t.split("."),o=translateObj.trad,i=0,n=e.length;i<n;i++){var s=e[i];if(!(s in o))return;o=o[s]}return o}var CloudSync=function(){return this.sync=nada,this.save=nada,this.remove=nada,this},LocalStorage=function(){var t=this;return this.setItem=function(t,e){window.localStorage.setItem(t,e)},this.getItem=function(t){return window.localStorage.getItem(t)},this.getAllItem=function(){return window.localStorage},this.removeItem=function(t){window.localStorage.removeItem(t)},this.clear=function(){window.localStorage.clear()},this.weight=function(){var t,e,o=window.localStorage,i=0,n="LS | --------------------------\n";for(e in o)i+=t=2*(o[e].length+e.length),n+="LS | "+e.substr(0,50)+" = "+(t/1024).toFixed(2)+" KB\n";return n+="LS | Total = "+(i/1024).toFixed(2)+" KB\n",n+="LS | --------------------------"},this.restoreUUID=function(){if(!appBrowser){var e=t.getAllItem(),o=getListUUID();for(var i in e)if(-1!=i.indexOf("mix-")){var n=jsonDecode(e[i]);notnull(n.uuid)&&t.setItem("uuid-"+n.uuid)}var s=getListUUID();uniqueBetweenArray(o,s).length>0&&storage.removeItem("restore-all-mix")}},this.restoreAllMix=function(e,o){var i=o||nada;if(!0===e&&storage.removeItem("restore-all-mix"),!appBrowser&&hasNetwork&&isnull(storage.getItem("restore-all-mix"))){var n={};n.uuid=getListUUID(),$.ajax({type:"POST",url:domainOnline+"ph3/get-all-mix-db.php",data:n,dataType:"json",crossdomain:!0,success:function(e){if("success"==e.state){var o=e.mixlist;o.forEach(function(t,e){t.online=!0,t.mymix=!0,localMixObject.saveMix(t)}),i({msg:"ok",nb:o.length}),t.setItem("restore-all-mix","ok"),saveGA("mix","get_all_db")}else i({msg:"bug"}),saveGA("mix","get_all_db_failed")},error:function(t){i({msg:"error"}),saveGA("mix","get_all_db_error")}})}},this.init=function(){t.restoreUUID(),t.restoreAllMix()},this},LocalMixObject=function(){var t=this;this.saveMix=function(t,e,o){var i=!!notnull(e)&&e,n=!notnull(o)||o;if(notnull(t)){var s=-1==t.link.indexOf("mix-")?"mix-"+t.link:t.link;s=i?s.replace("mix-","fav-"):s;var a=jsonEncode(t);return storage.setItem(s,a),n&&cloud.save(s,a),!0}return!1},this.deleteMix=function(t){return!!notnull(storage.getItem(t))&&(storage.removeItem(t),cloud.remove(t),!0)},this.deleteMixById=function(e){var o,i=t.getAllMix(!0),n=t.getAllMix(!0,!0);for(o in i)i[o].id==e&&(t.deleteMix("mix-"+i[o].link),t.deleteMix("fav-"+i[o].link));for(o in n)n[o].id==e&&(t.deleteMix("fav-"+n[o].link),t.deleteMix("mix-"+n[o].link))},this.getMix=function(t){return!!notnull(storage.getItem(t))&&jsonDecode(storage.getItem(t))},this.getAllMix=function(t,e){var o=!!notnull(t)&&t,i=!!notnull(e)&&e,n=[],s=storage.getAllItem(),a=i?"fav-":"mix-";for(var u in s)if(-1!=u.indexOf(a)){var r=jsonDecode(s[u]);isnull(r.datedb)&&(r.datedb=notnull(r.date)?r.date:getDateNow()),o&&-1==u.indexOf("v"+app.version)&&-1==u.indexOf("-IOSV"+app.version)||n.push(r)}return n},this.getMixlist=function(){var e=t.getAllMix(!0,!1);return t.sortArrayMix(e)},this.getFavlist=function(){var e=t.getAllMix(!0,!0);return t.sortArrayMix(e)},this.sortArrayMix=function(t,e){return t.sort(function(t,e){return e.datedb>t.datedb?1:e.datedb<t.datedb?-1:0}),!0===e&&(t=t.reverse()),t},this.getLastMix=function(){var e=t.getAllMix(!1),o=e.length;return o>0?e[o-1]:null},this.getLastDjName=function(){var e=t.getLastMix();return notnull(e)?e.name:""},this.deleteAllMix=function(){var t=storage.getAllItem();for(var e in t)-1==e.indexOf("mix-")&&-1==e.indexOf("fav-")||storage.removeItem(e)},this.getStatMixOnline=function(e){var o=[];t.getMixlist().forEach(function(t){t.online&&notnull(t.id)&&o.push(parseInt(t.id))}),o.length>0?xhr("GET",domainOnline+"ph3/get-stat-mix.php",{id:o},function(i){if("success"==i.state){XHRmemotime.mymix=new Date;var n=[];if(i.list.forEach(function(e){n.push(parseInt(e.id));var o=t.getMix("mix-"+e.link);o.id=e.id,o.newnbview=e.nbview,o.newnblike=e.nblike,t.saveMix(o)}),n.length<o.length){var s=uniqueBetweenArray(n,o);for(var a of s)t.deleteMixById(a)}void 0!==e&&e()}},function(t){}):void 0!==e&&e()},this.getStatFavOnline=function(e){var o=[];t.getFavlist().forEach(function(t){t.mymix&&!t.online||!notnull(t.id)||o.push(parseInt(t.id))}),o.length>0?xhr("GET",domainOnline+"ph3/get-stat-mix.php",{id:o},function(i){if("success"==i.state){XHRmemotime.myfav=new Date;var n=[];if(i.list.forEach(function(e){n.push(parseInt(e.id));var o=t.getMix("fav-"+e.link);o.id=e.id,o.nbview=e.nbview,o.nblike=e.nblike,t.saveMix(o,!0)}),n.length<o.length){var s=uniqueBetweenArray(n,o);for(var a of s)t.deleteMixById(a)}void 0!==e&&e()}},function(t){}):void 0!==e&&e()}},PoloObject=function(t,e,o,i,n,s){this.sound=new SoundObject(o,"polo"+t);var a=this,u=$("#polo"+t,e).css({left:n+20+"px",top:s+"px"}),r=$('<div class="zone"><div class="loader"><div class="bar"></div></div></div>'),c=$(".loader",r),p=$(".bar",r),l=!1;$boxLoaderPolo.append(r),r.css({left:n+20+"px"});var d,f,v,m,h,b,g,x,D,C,k,w,A,S,F,y,E,P,T,B,M,I,L,R,O,H,N=t,z=i,_="",j="normal",U=!1,G=spritePolo,V=Lt,W=.5,X=.3,Y=0,q=!1,Q="hd"==animeSize?2:1,Z="hd"==animeSize?2:1,J=400*Z,K=40*Z,tt=60*Z,et=u.find(".ctrl");this.$btcMute=u.find(".icon-game-bt-mute"),this.$btcSolo=u.find(".icon-game-bt-solo"),this.$btcStop=u.find(".icon-game-bt-delete"),this.posX=n*Z,this.posY=J,this.pictoHoverId=null,this.reinit=function(){st(),a.draw(),q=!1,a.pictoHoverId=null,h=b=g=x=D=C=k=0,_=w=A=S=F=y=null,E=P=T=B=M=I=L=R=!1},this.setPosition=function(){d=e.offset().left,f=e.offset().top,m=$incredibox.offset().top+($incredibox.outerHeight()-252)*stageScale,v={px:u.offset().left,py:u.offset().top,width:u.outerWidth()*stageScale*poloScale,height:u.outerHeight()*stageScale*poloScale}},this.getId=function(){return N},this.getPicto=function(){return w},this.getAssetId=function(){return A},this.getMoment=function(){return D},this.getLoop=function(){return C},this.getEnabled=function(){return P},this.getBusy=function(){return T},this.getHover=function(){return q},this.getMode=function(){return j},this.getDeleting=function(){return M},this.getPlaying=function(){return B},this.getDiv=function(){return u},this.getMute=function(){return I},this.getHide=function(){return R},this.getSolo=function(){return L},this.setSolo=function(t){(L=t)?a.$btcSolo.addClass("light"):a.$btcSolo.removeClass("light")},this.setLoop=function(t){C=t},this.setMoment=function(t){D=t},this.setPlaying=function(t){B=t},this.habiller=function(t,e,o,i,n){a.checkState(),w=t,A=t.getId(),D=e,S=o.imgData,y=o.headHeight,F=o.imgSprite,_=o.color,k=S.length,T=!0,p.css({"background-color":"#"+_}),U?a.mode("waiting"):(E=!0,TweenMax.delayedCall(i,function(){a.rebond(n)})),recordMix.xmlAction("append",a)},this.checkState=function(){M&&(U||(TweenMax.killTweensOf(a),a.remonte(0,!0,!1)))},this.deshabiller=function(t,e){E&&(E=!1,TweenMax.killTweensOf(a.rebond),TweenMax.killTweensOf(a.rebond2)),M=!0,T=!1,w.desactiver(),w.checkusedTouchStart();a.posY;var o=e?0:.3;TweenMax.to(a,o,{posY:J,ease:Quint.easeIn,onComplete:a.remonte,onCompleteParams:[0,!0,e],delay:t,overwrite:!0}),this.hideLoader(),recordMix.xmlAction("remove",a)},this.baisser=function(t,e){this.posY=J},this.remonte=function(t,e,o){if(U=!0,!0===e){var i=!modeReplay&&!modeRandom&&!modeWatch;w.reactiver(i),a.reinit(),majListPoloDrop()}a.mode("normal");var n=K+Math.round(Math.random()*tt),s=(a.posY,o?0:.4),u=o?0:t;TweenMax.to(a,s,{posY:n,ease:Back.easeOut,delay:u,onComplete:function(){U=!1},overwrite:!0})},this.rebond=function(t){var e=a.posY-20,o=B?"anime":"waiting",i=t?0:.1;o=a.getMute()?"mute":o,a.mode(o),TweenMax.to(a,i,{posY:e,ease:Quint.easeOut,onComplete:a.rebond2,onCompleteParams:[t],overwrite:!0}),E=!1},this.rebond2=function(t){var e=a.posY+20,o=t?0:.2;TweenMax.to(a,o,{posY:e,ease:Back.easeOut,overwrite:!0})},this.showLoader=function(){l=!0,c.addClass("show"),p.css({"animation-duration":decimal(getRemainingTime()/1e3,2)+"s"}),p.addClass("progress")},this.hideLoader=function(){l&&(l=!1,c.removeClass("show"),p.removeClass("progress"))},this.hideYourself=function(){(B||T)&&(R=!0,Y=I?1-X:Y,a.mode("hide"))},this.stopHidingYourself=function(){(B||T)&&a.mode("unhide")},this.stopHidingYourselfComplete=function(){R=!1,I?a.mode("mute"):B?a.mode("anime"):a.mode("waiting")};var ot=0,it=[],nt=[[0,1,2,2,1,0],[0,3,4,5,6,7,8,0],[0,3,4,4,3,0],[0,1,2,2,9,9,9,9,9,9,9,9,9,9,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,1,2,2,2,2,0],[0,1,2,2,9,9,9,9,9,9,9,9,9,9,9,9,9,9,1,2,2,9,9,9,9,2,2,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,0],[0,1,2,2,9,9,9,9,9,9,9,9,9,9,2,2,2,10,10,10,10,10,10,10,10,10,10,1,2,2,10,10,10,10,10,2,2,0]];function st(){var t=random(7)+2;TweenMax.delayedCall(t,at)}function at(){O=getTime();var t=random(nt.length-1);it=nt[t],H=it.length,ot=H/(36*H),a.mode("cligne")}var ut=appDesktop?420:400,rt=164*Z,ct=ut*Z,pt=164*Q,lt=ut*Q,dt=164*Z,ft=380*Z,vt=164*Q,mt=380*Q,ht=40,bt=492,gt=0,xt=97*Z,Dt=164*Z,Ct=ht*Z,kt=164*Q,wt=ht*Q,$t=450*Q,At=16*Q,St=16*Z,Ft=7*Z,yt=54,Et=110,Pt=95,Tt=110;function Bt(){z.globalAlpha=1,z.drawImage(G,0,0,pt,lt,a.posX,a.posY,rt,ct)}function Mt(t,e){t*=Q,e*=Q,z.drawImage(G,t,e,kt,wt,a.posX,a.posY+xt,Dt,Ct)}function It(){z.globalAlpha=1-W,z.drawImage(G,pt,0,pt,lt,a.posX,a.posY,rt,ct)}function Lt(){Bt(),Mt(bt,gt),It()}function Rt(){z.globalAlpha=1,z.drawImage(F,0,0,vt,mt,a.posX,a.posY,dt,ft)}function Ot(){Rt(),z.globalAlpha=1-X,z.drawImage(F,2*vt,0,vt,mt,a.posX,a.posY,dt,ft)}function Ht(){Rt(),Y=1,z.globalAlpha=Y,z.drawImage(F,2*vt,0,vt,mt,a.posX,a.posY,dt,ft)}function Nt(){Rt();var t=I?1-X:0;Y=Y<=t?t:decimal(Y-.1,2),z.globalAlpha=Y,z.drawImage(F,2*vt,0,vt,mt,a.posX,a.posY,dt,ft),Y<=t&&a.stopHidingYourselfComplete()}function zt(){E?Lt():(a.anime(),z.globalAlpha=1,z.drawImage(F,vt,0,vt,mt,a.posX,a.posY,dt,ft),z.drawImage(F,h,Math.ceil(b)+1,vt,Math.floor(y*Q)-1,a.posX+g,Math.ceil(a.posY+x)+1,dt,Math.floor(y*Z)-1))}function _t(){var t=timenow-O,e=Math.floor(t*ot);e=e>H-1?H-1:e,Bt(),Mt(bt,it[e]*ht),It(),e>=H-1&&a.mode("normal")}function jt(){if(M)zt();else{Bt();var t=a.getPupPos(yt,Et),e=a.getPupPos(Pt,Tt);z.drawImage(G,0,$t,At,At,t[0],t[1],St,St),z.drawImage(G,0,$t,At,At,e[0],e[1],St,St),mouseY<f+a.posY+50?Mt(328,120):mouseY>=f+a.posY+50&&mouseY<f+a.posY+100?Mt(328,80):mouseY>=f+a.posY+180?Mt(328,40):Mt(328,0)}}function Ut(){jt(),It()}function Gt(){jt()}this.mode=function(t){if(t!=j)switch(TweenMax.killTweensOf(at),j=t){case"normal":V=Lt,st();break;case"cligne":V=_t;break;case"regarde":V=Ut;break;case"hover":V=Gt;break;case"waiting":V=Rt;break;case"anime":V=zt;break;case"mute":V=Ot;break;case"hide":V=Ht;break;case"unhide":V=Nt}},this.draw=function(){V()},this.updateLoader=function(){},this.anime=function(){var t=frame;boucleA&&k==frameTotal&&(t+=frameHalf),h=S[t=t>=k-1?k-1:t][0]*Q,b=S[t][1]*Q,g=S[t][2]*Z,x=S[t][3]*Z},this.getPupPos=function(t,e){var o=(mouseX-d)/stageScale,i=(mouseY-f)/stageScale,n=o/poloScale-t-this.posX/Z,s=i/poloScale-e-this.posY/Z,u=Math.atan2(s,n);return[Ft*Math.cos(u)+(a.posX+t*Z),Ft*Math.sin(u)+(a.posY+e*Z)]};var Vt=0,Wt=0,Xt=isTouchCapable?60*stageScale:20,Yt=0,qt=isTouchCapable?60*stageScale:20;function Qt(t){notnull(t)&&t.preventDefault(),L?(1==getTotalSolo()?stopSoloPolo():a.mute(),L=!1):a.switchMute(),I||L||stopOtherSolo()}function Zt(t){notnull(t)&&t.preventDefault(),clickPolo(a)}function Jt(t){notnull(t)&&t.preventDefault(),L?(L=!1,unmuteAll(a)):(L=!0,muteAll(a))}this.activerClick=function(){P=!0,u.on(evtPress,a.touchStart),a.activerCtrl()},this.desactiverClick=function(){P=!1,TweenMax.killTweensOf(a.touchLong),u.off(evtPress,a.touchStart),u.off(evtMove,a.touchMove),u.off(evtPressEnd,a.touchEnd),a.desactiverCtrl()},this.touchStart=function(t){t.preventDefault(),!1;var e=notnull((t=~t.type.indexOf("touch")?t.originalEvent:t).targetTouches)?t.targetTouches[0]:t;Vt=Wt=e.pageX,Yt=e.pageY,TweenMax.delayedCall(.25,a.touchLong,[t]),u.off(evtPress,a.touchStart),u.on(evtMove,a.touchMove),u.on(evtPressEnd,a.touchEnd)},this.touchMove=function(t){t.preventDefault();var e=notnull((t=~t.type.indexOf("touch")?t.originalEvent:t).targetTouches)?t.targetTouches[0]:t;Wt=e.pageX,e.pageY>Yt+qt&&Math.abs(Wt-Vt)<Xt&&(TweenMax.killTweensOf(a.touchLong),clickPolo(a))},this.touchLong=function(t){t.preventDefault(),TweenMax.killTweensOf(a.touchLong),L=!0,soloPolo(),a.$btcSolo.addClass("light")},this.touchEnd=function(t){t.preventDefault(),!0,TweenMax.killTweensOf(a.touchLong),u.off(evtMove,a.touchMove),u.off(evtPressEnd,a.touchEnd),u.on(evtPress,a.touchStart),L?(1==getTotalSolo()?stopSoloPolo():a.mute(),L=!1,a.$btcSolo.removeClass("light")):a.switchMute()},this.activerCtrl=function(){isMouseDevice&&!isTouchDevice&&(et.addClass("visible").on(evtPress,stopProp),a.$btcMute.on(evtClick,Qt),a.$btcSolo.on(evtClick,Jt),a.$btcStop.on(evtClick,Zt))},this.desactiverCtrl=function(){isMouseDevice&&!isTouchDevice&&(et.removeClass("visible").off(),a.$btcMute.off().removeClass("light"),a.$btcSolo.off().removeClass("light"),a.$btcStop.off().removeClass("light"))},this.playSound=function(){B=!0,this.sound.play(),C++},this.stopSound=function(t){B=!1,this.sound.stop(t)},this.mute=function(){I=!0,R||(a.mode("mute"),a.$btcMute.addClass("light")),a.sound.mute(),recordMix.xmlAction("mute",a)},this.unmute=function(){I=!1,R||(B?this.mode("anime"):this.mode("waiting"),a.$btcMute.removeClass("light")),this.sound.unmute(),recordMix.xmlAction("unmute",a)},this.switchMute=function(){I?a.unmute():a.mute()},this.hitTest=function(t,e){var o=t/stageScale,i=e/stageScale;return o>v.px&&o<v.px+v.width&&i>v.py&&i<m},this.hitTestPicto=function(t){if(!T&&!M){var e=t.getBound();return a.hitTest(Math.round(e.px*stageScale),Math.round(e.py*stageScale))}return!1},this.rollover=function(){q||(q=!0,a.mode("hover"))},this.rollout=function(t){!!notnull(t)&&t?(q=!1,a.mode("normal")):q&&(q=!1,a.mode("regarde"))},this.setPosition(),this.reinit()},PictoObject=function(t,e){var o,i,n,s=this,a=t,u=$("#picto"+a,e),r=$(".scale",u),c=!1,p=u.innerWidth(),l=0,d=isMobile?1.1:1.2,f=0,v={px:0,py:0};this.getDiv=function(){return u},this.getId=function(){return a},this.getColor=function(){},this.use=!1,this.polo=null,this.init=function(t,e){f=-a*p,u.css({top:e+"px",left:t+"px"}),r.css({"background-position":String(f)+"px 0px"}),s.setPosition()},this.setPosition=function(){u.parent().offset().top,u.parent().offset().left,i=u.offset().left,n=u.offset().top},this.getBound=function(){return v},this.activer=function(){s.desactiver(),u.on(evtPress,s.touchStart)},this.desactiver=function(){u.off(),notnull(o)&&(o.off(evtMove,s.touchMove),o.off(evtPressEnd,s.touchEnd),o.off(evtPressEnd,s.usedTouchEnd))},this.touchStart=function(t){t.preventDefault(),c||(isMouseDevice&&!isTouchDevice&&$(".polo").addClass("noPointerEvents"),c=!0,u.off(),(o=~t.type.indexOf("touch")?u:$body).on(evtMove,s.touchMove),o.on(evtPressEnd,s.touchEnd),u.removeClass("flashme"),u.addClass("drag"),s.touchMove(t),pictoOnDrag(s))},this.touchMove=function(t){t.preventDefault();var e=notnull((t=~t.type.indexOf("touch")?t.originalEvent:t).targetTouches)?t.targetTouches[0]:t;s.bouger(e.pageX,e.pageY),t.preventDefault(),pictoOnMove(s)},this.touchEnd=function(t){t.preventDefault(),isMouseDevice&&!isTouchDevice&&$(".polo").removeClass("noPointerEvents"),s.stopDrag(),pictoOnDrop(s)},this.stopDrag=function(){c=!1,o.off(evtMove,s.touchMove),o.off(evtPressEnd,s.touchEnd),u.removeClass("drag")},this.bouger=function(t,e){v={px:t,py:e};var o=(t-i)/stageScale,s=(e-n)/stageScale;o-=p/2*pictoScale,s-=p/d*pictoScale,o/=pictoScale,s/=pictoScale,u.css({transform:"translate3d("+o+"px, "+s+"px, 0px)"})},this.replacer=function(){c&&s.stopDrag(),u.addClass("replacer").one(animationEnd,s.replacerFini)},this.absorber=function(t){u.css({transform:"translate3d(0px, 0px, 0px)"}),r.css({"background-position":String(f)+"px -68px"}),u.removeClass("replacer"),u.addClass("griser"),s.use=!0,s.polo=t,u.off().on(evtPress,s.usedTouchStart)},this.reactiver=function(t){var e=!!notnull(t)&&t;r.css({"background-position":String(f)+"px 0px"}),u.removeClass("griser"),!e||modeRandom||modeReplay?s.replacerFini():u.addClass("flashme").one(animationEnd,function(t){$(t.target).removeClass("flashme"),s.replacerFini()})},this.replacerFini=function(){u.removeClass("replacer"),u.css({transform:"translate3d(0px ,0px, 0px)"}),s.use=!1,s.activer()},this.usedTouchStart=function(t){t.preventDefault(),l=getTime(),showPoloInArray([s.polo.getId()]),o.on(evtPressEnd,s.usedTouchEnd)},this.usedTouchEnd=function(t){t.preventDefault(),o.off(evtPressEnd,s.usedTouchEnd),stopShowingPoloInArray(l),l=0},this.checkusedTouchStart=function(){0!=l&&s.usedTouchEnd()}},BonusObject=function(t,e,o,i){var n,s=this,a=e,u=t+1,r=$("#bt-bonus-"+u),c=r.find(".quarter"),p=$(".circle",r),l=$("#box-video .video#video"+u),d=$("#box-video .video#video"+u+" video")[0],f=!1,v=!1,m=!1,h=new SoundObject(o,"bonus"+u),b=new SoundObject(o,"aspire"+u),g=new SoundObject(o,"expire"+u),x=i.snd,D=i.aspire,C=i.expire,k=numberArray(a.code.split(",")),w=k.length,A=[],S=0,F=0;this.tabSVG=A,this.video=d,this.found=!1,this.unlock=!1,s.cntCode=0,this.init=function(){var t=storage.getItem("v"+appVersion+"-bonus-complete")||0;s.getId()<=t&&s.unlockme();for(var e=0;e<w;e++){var o={obj:$(".svg.q"+(e+1),c),col:$(".svg.q"+(e+1)+" svg",c).css("fill")};A.push(o)}s.modeTouch()},this.reinit=function(){s.hideLoader(),r.removeClass("inprogress found bounce"),c.find(".svg").removeClass("directshow show hide"),s.found=!1,s.inprogress=!1,s.cntCode=0,s.modeTouch()},this.modeTouch=function(){r.off().on(evtPress,s.touchStart)},this.modeClick=function(){r.off().on("click",s.launchVideo)},this.unlockme=function(){r.addClass("unlock"),this.unlock=!0},this.getId=function(){return u-1},this.getCode=function(){return k};var y=$('<div class="zone"><div class="loader"><div class="bar"></div></div></div>'),E=$(".loader",y),P=$(".bar",y),T=!1;$boxLoaderBonus.append(y),this.showLoader=function(){T=!0,E.addClass("show"),P.css({"animation-duration":decimal(getRemainingTimeBeforeBonus()/1e3,2)+"s"}),P.addClass("progress")},this.hideLoader=function(){T&&(T=!1,E.removeClass("show"),P.removeClass("progress"))};var B=new ClockObject("canvas-bt-bonus-"+u);B.init(43,43,1,35,16),this.playAspiration=function(t){t=notnull(t)?t:0,b.prepare(D,0),b.play(t,!0),m=!0},this.stopAspiration=function(){m&&(b.stop(),m=!1)},this.playExpiration=function(){g.prepare(C,1),g.play(0,!0)},this.stopExpiration=function(){g.stop()},this.hasCode=function(t){return-1!=k.indexOf(t)},this.checkCode=function(t,e){var o=k.indexOf(t);o>-1&&(e?s.showQuarter(o):s.hideQuarter(o))},this.showQuarter=function(t){s.cntCode++;var e=A[t].obj,o=A[t].col;s.cntCode==w&&s.unlock&&s.hasBeenFound(),1==s.cntCode&&(s.inprogress=!0,r.addClass("inprogress")),p.addClass("show").one(animationEnd,function(t){$(t.target).removeClass("show")}),p.css({"border-color":o}),e.removeClass("hide").addClass("directshow show")},this.hideQuarter=function(t){var e=A[t].obj;s.unlock?e.addClass("hide").one(animationEnd,function(t){$(t.target).removeClass("directshow show hide")}):e.removeClass("directshow show hide"),s.cntCode==w&&(cancelClickBtBonus(),this.notFoundAnymore()),s.cntCode--,s.cntCode<0&&(s.cntCode=0),0==s.cntCode&&(s.inprogress=!1,r.removeClass("inprogress"))},this.hideClock=function(){B.stop(!0)},this.render=function(t){B.render()},this.hasBeenFound=function(){modeReplay||(r.addClass("found bounce"),popupBonusUnlocked()),s.modeClick(),s.found=!0},this.notFoundAnymore=function(){modeReplay||r.removeClass("found bounce"),s.found=!1,s.hideClock(),s.hideLoader(),s.modeTouch()},this.touchStart=function(t){t.preventDefault(),s.unlock?bonusPlaying||((n=~t.type.indexOf("touch")?r:$body).on(evtPressEnd,s.touchEnd),S=getTime(),showPoloAndPictoInCombo(u)):popupFindPreviousBonus()},this.touchEnd=function(t){t.preventDefault(),n.off(evtPressEnd,s.touchEnd),stopShowingPoloInArray(S)},this.launchVideo=function(){if(!bonusWaiting&&!bonusPlaying){var t=!app.bonusloopA||boucleA;!modeWatch&&getRemainingTime()<500&&t||(v=!0,s.modeTouch(),s.showLoader(),recordMix.xmlAction("bonus",s),clickBtBonus(u),r.removeClass("bounce"),p.addClass("showCircle").one(animationEnd,function(t){$(t.target).removeClass("showCircle")}),s.prepareVideo(1))}},this.prepareVideo=function(t){0,F=app.looptime*(t-1)/1e3,d.currentTime=F},this.videoPlaying=function(){},this.videoEnded=function(){},this.loopAtFirstFrame=function(){0,d.currentTime=F},this.checkCurrentTime=function(){},this.play=function(){d.play(),v=!1,f=!0,m=!1,d.currentTime=F,r.addClass("playing"),s.hideLoader(),B.start(loopDuration*app.nbloopbonus,!1),h.prepare(x),h.play(F),l.addClass("show")},this.stop=function(t){r.removeClass("playing"),loopOn&&s.found&&s.modeClick(),f&&(h.stop(),B.stop(!0)),s.stopAspiration(),v=!1,f=!1,l.removeClass("show")},this.pause=function(){v&&d.pause(),f&&(d.pause(),h.pause()),m&&b.pause(),B.pause()},this.resume=function(){v&&d.play(),f&&(d.play(),h.unpause()),m&&b.unpause(),B.resume()},this.init()},SoundObject=function(t,e){var o,i,n,s,a,u=this,r=t,c=null,p=null,l=null,d=!1,f=!1,v=isIOS,m=!1,h=!1,b=v?0:1e-4,g=debugMute?b:1;this.getMute=function(){return d},this.getDuration=function(){return null!=p?p.duration:0},this.getCurrentTime=function(){return null!=c&&null!=c.context?c.context.currentTime:0},this.setSilence=function(){g=b,h=!0},this.setVolume=function(t){v?o.gain.value=t:o.gain.setValueAtTime(t,r.currentTime)},this.onComplete=function(t){c.onended=t,l=t},this.prepare=function(t,e){p=t,(c=(r=contextAudio).createBufferSource()).buffer=p,p.duration,o=r.createGain();var i=0==e||d||h?b:g;u.setVolume(i),c.connect(o),o.connect(r.destination)},this.play=function(t,e){m=!0,i=getTime(),s=(s=(s=decimal(t,3)||0)>u.getDuration()?decimal(u.getDuration(),2)-.01:s)<0?0:s,c.start(0,s),!0!==e||d||h||u.fadeIn()},this.stop=function(t){!0===t||null===c||!m||h||d?u.stopSource():u.fadeOut(!0)},this.stopSource=function(){clearInterval(a),null!=c&&m&&(isIOS&&iosVersionNumber<103?c.noteOff(0):c.stop(0),c.onended=null),c=null,o=null,f||(d=!1,i=0,n=0,s=0,l=null,m=!1)},this.fadeOut=function(t){var e=!0===t;v?(clearInterval(a),a=setInterval(function(){var t=decimal(o.gain.value-.15,1);t=t<=b?b:t,o.gain.value=t,t<=b&&(clearInterval(a),e&&u.stopSource())},10)):(o.gain.setValueAtTime(o.gain.value,r.currentTime),o.gain.exponentialRampToValueAtTime(b,r.currentTime+.025),e&&(c.stop(r.currentTime+.025),c.onended=u.stopSource))},this.fadeIn=function(){v?(clearInterval(a),a=setInterval(function(){var t=decimal(o.gain.value+.15,1);t=t>=g?g:t,o.gain.value=t,t>=g&&clearInterval(a)},10)):(o.gain.setValueAtTime(o.gain.value,r.currentTime),o.gain.exponentialRampToValueAtTime(g,r.currentTime+.025))},this.mute=function(){null==c||h||u.fadeOut(),d=!0},this.unmute=function(){null==c||h||u.fadeIn(),d=!1},this.pause=function(){f=!0,n=getTime(),u.stop()},this.unpause=function(){if(f=!1,this.prepare(p,0),null!=c&&(notnull(l)&&(c.onended=l),m)){var t=n-i;t=t<0?0:t,u.play(s+t/1e3,!0)}}},ClockObject=function(t){var e,o,i,n,s,a,u,r,c,p,l,d=$("#"+t)[0].getContext("2d"),f=2*Math.PI,v=Math.PI/2,m=!1,h=!1,b=0;this.start=function(t,e){u=isDarkMode()?"#CCCCCC":"#5A5A5A",d.strokeStyle=u,m=!0,h=!1,l=e,p=100/t,c=getTime()},this.stop=function(t){m=!1,t?d.clearRect(o-s-a/2,i-s-a/2,2*s+a,2*s+a):(h=!0,e=l?0:1)},this.pause=function(){b=getTime()},this.resume=function(){var t=getTime()-b;c+=t},this.render=function(){if(m||h){if(m){var t=getTime()-c;r=t*p/100}else h&&(r+=.2*(e-r));r<.001&&(r=.001),r>.999&&(r=.999);var n=l?-v:f*r-v,u=l?f*r-v:-v;d.clearRect(o-s-a/2,i-s-a/2,2*s+a,2*s+a),d.beginPath(),d.arc(o,i,s,n,u,!1),d.stroke(),h&&(.001!=r&&.999!=r||(h=!1,d.clearRect(o-s-a/2,i-s-a/2,2*s+a,2*s+a)))}};this.checkAtEnd=function(){!0},this.init=function(t,e,r,c,p,l){o=void 0==t?0:t,i=void 0==e?0:e,n=void 0==r?1:r,s=void 0==c?18:c,a=void 0==p?6:p,u=void 0==l?"#FFFFFF":l,d.lineWidth=a,d.strokeStyle=u,d.globalAlpha=n}},ReadingBar=function(t,e,o){var i,n=this,s=$(t),a=$("#reading-buffer",s),u=$cntRecord.find("#t-spent"),r=$cntRecord.find("#t-duration"),c="00:00",p=!1,l=0,d="record",f=secToText(app.looptime*app.recmaxloop),v=0,m=0;this.minLoop=e,this.maxLoop=o,this.maxTime=0,this.cntLoop=0,this.bonusList=[],this.isFinished=function(){return this.cntLoop==this.maxLoop},this.isLastLoop=function(){return this.cntLoop+1==this.maxLoop},this.open=function(t,e){return d=t,n.createRecordBlock(e),n.cntLoop=0,n.maxTime="record"==d?f:secToText(n.maxLoop*app.looptime),a.css({transform:"scaleX(0)"}),c="00:00",u.text(c),r.text(" / "+n.maxTime),v=0,m=100/readingBar.maxLoop,s.addClass("open"),$cntRecord.addClass("fadeIn"),n},this.close=function(){return removeTransition(s,"open","transform",function(){a.removeClass("progress"),$("#reading-marker").empty(),$("#reading-marker-bonus").empty(),n.bonusList=[]}),$cntRecord.removeClass("fadeIn cssdelay"),n},this.start=function(){return p=!0,n.cntLoop=0,l=0,"record"==d?recordMix.start():replayMix.start(),n.render(),v=Math.floor(l+i)/n.maxLoop,a.css({transform:"scaleX("+v/100+")","animation-duration":decimal(n.maxLoop*app.looptime/1e3,2)+"s"}),a.addClass("progress"),n},this.stop=function(){return p=!1,"record"==d?recordMix.stop():replayMix.stop(),n},this.froze=function(){a.addClass("froze")},this.seek=function(t){n.cntLoop=t,a.removeClass("progress"),resetAnimationCSS(a[0]),a.css({transform:"scaleX("+m*n.cntLoop/100+")"}),n.render()},this.unfroze=function(){a.css({transform:"scaleX("+m*n.cntLoop/100+")","animation-duration":decimal((n.maxLoop-n.cntLoop)*app.looptime/1e3,2)+"s"}),a.removeClass("froze").addClass("progress")},this.openBig=function(){s.addClass("seeking")},this.openNormal=function(){s.removeClass("seeking")},this.loop=function(){return n.cntLoop++,l+=i,n.isFinished()?"record"==d?stopRecordMode():stopReplayMode():"record"==d?recordMix.loop():replayMix.loop(),n},this.render=function(){if(p){i=pctMetronome;var t=secToText(getTimeSpent()+loopDuration*n.cntLoop);c!=t&&(c=t,u.text(c))}},this.createRecordBlock=function(t){var e="record"==d?"#D20A0A":isMiniPlayer?"#2C86FE":"#36B460",o="record"==d?decimal(n.minLoop/n.maxLoop,2):0;if($("#reading-block",s).css({transform:"scale("+o+", 1)"}),$($cntRecord).css({color:e}),a.css({"background-color":e}),!0===t){var i="",u=parseFloat($incredibox.css("width"))/n.maxLoop,r=0;for(r=0;r<n.maxLoop;r++){i+="<div class='marker' style='left:"+u*r+"px'></div>"}for($("#reading-marker").html(i),i="","",r=0;r<n.bonusList.length;r++){i+="<div class='marker' style='left:"+u*n.bonusList[r].loopIndex+"px; width:"+u+"px'></div>"}$("#reading-marker-bonus").html(i)}},this.createRecordBlock()},RenderRAF=function(t,e){var o,i,n=t||-1,s=e||function(){},a=!1;function u(){if(a)return!1;o=requestAnimationFrame(u),s()}this.start=function(t){a=!1,0,1e3/(n=t||n),i=Date.now(),i,u()},this.stop=function(){a=!0,cancelAnimationFrame(o)}},Spinner={$bt:null,$svg:null,xlink:"",add:function(t){notnull(t)&&(this.$bt=t,this.$svg=this.$bt.find("svg use"),this.$svg.length>0&&(this.xlink=this.$svg.attr("xlink:href"),this.$svg.attr("xlink:href","#ic-loader")),this.$bt.addClass("spin"))},reset:function(){notnull(this.$bt)&&this.$bt.removeClass("spin"),notnull(this.$svg)&&this.$svg.length>0&&this.$svg.attr("xlink:href",this.xlink),this.$bt=null,this.$svg=null,this.xlink=""}};function CanvasObj(t){var e,o=this;return this.id=t,this.div=document.getElementById(t),this.context=this.div.getContext("2d"),this.width=this.div.offsetWidth,this.height=this.div.offsetHeight,this.saveImage=function(){e=o.context.getImageData(0,0,o.width,o.height)},this.showImage=function(){o.clear(),o.context.putImageData(e,0,0)},this.clear=function(){o.context.clearRect(0,0,o.width,o.height)},this}function estimateSpeed(){}var focusList=[],focusPos=-1,$focused,focusHistory=[],$visibleScroll;function initFocusEvent(){appBrowserExpo||(document.addEventListener("keydown",keyDown,!1),$(document).on(evtPress,removeFocus))}function killFocusEvent(){appBrowserExpo||(document.removeEventListener("keydown",keyDown,!1),$(document).off(evtPress,removeFocus))}function keyDown(t){var e=t.key.toLowerCase();t.shiftKey&&9==t.keyCode||(9==t.keyCode&&t.preventDefault(),27==t.keyCode&&t.preventDefault(),38==t.keyCode&&t.preventDefault(),40==t.keyCode&&t.preventDefault(),$("input").is(":focus")||(13==t.keyCode&&t.preventDefault(),37==t.keyCode&&t.preventDefault(),39==t.keyCode&&t.preventDefault()),hitKey(e))}function nextFocus(){if(focusPos++,"playlist-boxline"==focusHistory[focusHistory.length-1]){focusPos=focusPos>focusList.length-1?focusList.length-1:focusPos;var t=$visibleScroll.find(".line.focused").index();t>0&&$visibleScroll[0].scroll({top:116*t,left:0,behavior:"smooth"})}else focusPos=focusPos>focusList.length-1?0:focusPos;addFocus()}function prevFocus(){if(focusPos--,"playlist-boxline"==focusHistory[focusHistory.length-1]){focusPos=focusPos<0?0:focusPos;var t=$visibleScroll.find(".line.focused").index();t>0&&$visibleScroll[0].scroll({top:116*t-232,left:0,behavior:"smooth"})}else focusPos=focusPos<0?focusList.length-1:focusPos;addFocus()}function addFocus(t){notnull($focused)&&($focused.removeClass("focused"),$focused=null),notnull(t)&&(focusPos=t),focusList.length>0&&($focused=focusList[focusPos].toFocus).addClass("focused")}function removeFocus(){notnull($focused)&&($focused.removeClass("focused"),$focused=null,focusPos=-1)}function enterFocus(){notnull($focused)&&(notnull(focusList[focusPos].onEnter)?focusList[focusPos].onEnter():notnull(focusList[focusPos].toClick)?focusList[focusPos].toClick.trigger(evtClick.split(" ")[0]):focusList[focusPos].toFocus.trigger(evtClick.split(" ")[0]))}function deleteFocus(){if("popup-menu-exit"==focusHistory[focusHistory.length-1])return!1;notnull($focused)&&($focused.removeClass("focused"),$focused=null),focusList=[],focusPos=-1}function hitKey(t){switch(t){case"tab":$("input").is(":focus")&&blurAll(),nextFocus();break;case"enter":if(isnull($focused)&&"pop-safe-code"==focusHistory[focusHistory.length-1])return focusList[10].toFocus.trigger(evtClick.split(" ")[0]),!1;$("input").hasClass("focused")&&$("input").is(":focus")&&(blurAll(),nextFocus()),enterFocus();break;case"escape":if($("input").is(":focus"))return blurAll(),!1;if(appDesktop)return removeFocus(),boxMenu.isOpen()?(boxMenu.close(),!1):(popupMenuExit(),!1);if(notnull($focused))return removeFocus(),!1;if(pageApp&&pause)return!1;if(boxDialog.isOpen())return!1;if(pageApp&&$lockAll.hasClass("show"))return!1;if("pop-safe-code"==focusHistory[focusHistory.length-1])return boxPopup.close(),!1;if("popup-news"==focusHistory[focusHistory.length-1])return boxPopup.close(),!1;if("popup-switch"==focusHistory[focusHistory.length-1])return boxSwitch.close(),!1;if(boxInfo.isOpen())return"popup-info"==focusHistory[focusHistory.length-1]?boxInfo.close():createFocus("popup-info",0),!1;if(boxParam.isOpen())return"popup-param"==focusHistory[focusHistory.length-1]?boxParam.close():createFocus("popup-param",0),!1;if(pageApp&&boxPopup.isOpen())return boxPopup.$popup.hasClass("action")||boxPopup.$popup.hasClass("action-back")?boxPopup.$popup.find("span.icon").trigger(evtClick.split(" ")[0]):boxPopup.close(),!1;if(pageApp&&$mixlist.isOpen()){if("playlist-line-open"==focusHistory[focusHistory.length-1])return $lineOpened.trigger(evtPress.split(" ")[0]).trigger(evtPressEnd.split(" ")[0]),!1;if("playlist-boxline"==focusHistory[focusHistory.length-1])return createFocus("popup-playlist",0),!1;if("playlist-boxfilter"==focusHistory[focusHistory.length-1])return createFocus("popup-playlist",0),!1;if("popup-playlist"==focusHistory[focusHistory.length-1])return closePlaylist(),!1}break;case" ":!(pageApp&&onGame&&loopOn)||$lockAll.hasClass("show")||void 0!==boxMenu&&boxMenu.isOpen()||$btClock.trigger(evtClick.split(" ")[0]);break;case"arrowright":$("input").is(":focus")||nextFocus();break;case"arrowleft":$("input").is(":focus")||prevFocus();break;case"arrowdown":$("input").is(":focus")||nextFocus();break;case"arrowup":$("input").is(":focus")||prevFocus();break;case"1":"pop-safe-code"==focusHistory[focusHistory.length-1]&&focusList[0].toFocus.trigger(evtClick.split(" ")[0]);break;case"2":"pop-safe-code"==focusHistory[focusHistory.length-1]&&focusList[1].toFocus.trigger(evtClick.split(" ")[0]);break;case"3":"pop-safe-code"==focusHistory[focusHistory.length-1]&&focusList[2].toFocus.trigger(evtClick.split(" ")[0]);break;case"4":"pop-safe-code"==focusHistory[focusHistory.length-1]&&focusList[3].toFocus.trigger(evtClick.split(" ")[0]);break;case"5":"pop-safe-code"==focusHistory[focusHistory.length-1]&&focusList[4].toFocus.trigger(evtClick.split(" ")[0]);break;case"6":"pop-safe-code"==focusHistory[focusHistory.length-1]&&focusList[5].toFocus.trigger(evtClick.split(" ")[0]);break;case"7":"pop-safe-code"==focusHistory[focusHistory.length-1]&&focusList[6].toFocus.trigger(evtClick.split(" ")[0]);break;case"8":"pop-safe-code"==focusHistory[focusHistory.length-1]&&focusList[7].toFocus.trigger(evtClick.split(" ")[0]);break;case"9":"pop-safe-code"==focusHistory[focusHistory.length-1]&&focusList[8].toFocus.trigger(evtClick.split(" ")[0]);break;case"0":"pop-safe-code"==focusHistory[focusHistory.length-1]&&focusList[9].toFocus.trigger(evtClick.split(" ")[0]);break;case"backspace":"pop-safe-code"==focusHistory[focusHistory.length-1]&&boxPopup.$popup.find(".text").text("_ _ _ _")}}function createFocus(t,e,o){if(appDesktop&&boxMenu.isOpen()&&"popup-menu-exit"!=t)return removeInArray("popup-menu-exit",focusHistory),focusHistory.push(t),focusHistory.push("popup-menu-exit"),!1;if(boxDialog.isOpen()&&"popup-dialog"!=t)return removeInArray("popup-dialog",focusHistory),focusHistory.push(t),focusHistory.push("popup-dialog"),!1;if(deleteFocus(),appDesktop&&"popup-menu-exit"==t&&(boxMenu.$popup.find(".bt-mini").each(function(t){focusList.push({toFocus:$(this)})}),focusList.push({toFocus:boxMenu.$popup.find("span.icon")})),pageApp&&"home"==t&&(void 0!=$homeBtNews&&$homeBtNews.length>0&&focusList.push({toFocus:$homeBtNews.find(".bck"),toClick:$homeBtNews}),$("#home-bt-fs").is(":visible")&&focusList.push({toFocus:$("#home-bt-fs").find(".bck"),toClick:$("#home-bt-fs")}),focusList.push({toFocus:$homeBtInfo.find(".bck"),toClick:$homeBtInfo}),focusList.push({toFocus:$homeBtParam.find(".bck"),toClick:$homeBtParam}),focusList.push({toFocus:$homeBtSwitch.find(".bck"),toClick:$homeBtSwitch}),focusList.push({toFocus:$homeBtPlay.find(".bck"),onEnter:function(){$homeBtPlay.trigger("click")}}),focusList.push({toFocus:$homeBtList.find(".bck"),onEnter:function(){$homeBtList.trigger("click")}})),"popup-news"==t&&focusList.push({toFocus:boxPopup.$popup.find(".bt-mini")}),"popup-info"==t&&$("#pop-info .box-tab .tab").each(function(t){focusList.push({toFocus:$(this)})}),"pop-tuto"==t&&$("#pop-info #pop-tuto .bt").each(function(t){focusList.push({toFocus:$(this).find(".bck"),toClick:$(this)})}),"pop-credit"==t&&$("#pop-info #pop-credit .bt-mini").each(function(t){focusList.push({toFocus:$(this)})}),"pop-follow"==t&&($("#pop-info #pop-follow .bt").each(function(t){focusList.push({toFocus:$(this).find(".bck"),toClick:$(this)})}),focusList.push({toFocus:$("#pop-info #pop-follow #img-shop")})),"popup-param"==t&&$("#pop-param .box-tab .tab").each(function(t){focusList.push({toFocus:$(this)})}),"pop-language"==t&&$("#pop-param #pop-language .bt-mini").each(function(t){focusList.push({toFocus:$(this)})}),"pop-setting"==t&&$("#pop-param #pop-setting .bt-mini").each(function(t){focusList.push({toFocus:$(this)})}),"pop-safe-code"==t&&(boxPopup.$popup.find(".bt-mini").each(function(t){focusList.push({toFocus:$(this)})}),focusList.push({toFocus:boxPopup.$popup.find("span.icon")})),"index-select"==t&&($("#sp-select .icon:not(.open)").each(function(t){focusList.push({toFocus:$(this).find(".img"),toClick:$(this)})}),focusList.push({toFocus:$("#home-bt-info").find(".bck"),toClick:$("#home-bt-info")}),focusList.push({toFocus:$("#home-bt-param").find(".bck"),toClick:$("#home-bt-param")})),"popup-switch"==t&&$("#sp-select .icon:not(.open)").each(function(t){focusList.push({toFocus:$(this).find(".img"),toClick:$(this)})}),"toolbar"==t&&(focusList.push({toFocus:$btTool.find(".bck"),toClick:$btTool}),focusList.push({toFocus:$btClock})),"toolbar-open"==t&&$("#game #box-bt1 .bt").each(function(t){focusList.push({toFocus:$(this).find(".bck"),toClick:$(this)})}),"game-paused"==t&&("visible"==$lockPause.css("visibility")?focusList.push({toFocus:$lockPause.find("#bt-resume"),toClick:$lockPause}):focusList.push({toFocus:$btClock})),"mode-replay"==t&&(focusList.push({toFocus:$btTool.find(".bck"),toClick:$btTool}),focusList.push({toFocus:$btClock}),"visible"===$btSave.css("visibility")?focusList.push({toFocus:$btSave.find(".bck"),toClick:$btSave}):$btLike.is(":visible")&&focusList.push({toFocus:$btLike.find(".bck"),toClick:$btLike})),"popup-record-complete"==t&&(boxPopup.$popup.find(".box-bt-haut .bt").each(function(t){focusList.push({toFocus:$(this).find(".bck"),toClick:$(this)})}),focusList.push({toFocus:boxPopup.$popup.find("span.icon")})),"popup-save-form"==t&&(boxPopup.$popup.find(".formzone .formline input").each(function(t){var e=$(this);focusList.push({toFocus:e,onEnter:function(){var t=e.val().length;e.focus(),e[0].setSelectionRange(t,t)}})}),focusList.push({toFocus:boxPopup.$popup.find(".bt-onofftext")}),focusList.push({toFocus:boxPopup.$popup.find(".bt.valid").find(".bck"),toClick:boxPopup.$popup.find(".bt.valid")}),focusList.push({toFocus:boxPopup.$popup.find("span.icon")})),"popup-mix-saved"==t&&(boxPopup.$popup.find(".box-bt-haut .bt").each(function(t){focusList.push({toFocus:$(this).find(".bck"),toClick:$(this)})}),focusList.push({toFocus:boxPopup.$popup.find("span.icon")})),"popup-global-share"==t&&(boxPopup.$popup.find(".box-bt-haut .bt").each(function(t){focusList.push({toFocus:$(this).find(".bck"),toClick:$(this)})}),focusList.push({toFocus:boxPopup.$popup.find("span.icon")})),"popup-email-form"==t&&(boxPopup.$popup.find(".formzone .formline input").each(function(t){var e=$(this);focusList.push({toFocus:e,onEnter:function(){var t=e.val().length;e.focus(),e[0].setSelectionRange(t,t)}})}),focusList.push({toFocus:boxPopup.$popup.find(".bt.valid").find(".bck"),toClick:boxPopup.$popup.find(".bt.valid")}),focusList.push({toFocus:boxPopup.$popup.find("span.icon")})),"popup-convert-mix"==t&&focusList.push({toFocus:boxPopup.$popup.find("span.icon")}),"popup-convert-mix-ready"==t){var i=boxPopup.$popup.find("#bt-save-file");focusList.push({toFocus:i.find(".bck"),onEnter:function(){i[0].click()}}),focusList.push({toFocus:boxPopup.$popup.find("span.icon")})}if("popup-dialog"==t&&$("#pop-dialog .bt-mini").each(function(t){focusList.push({toFocus:$(this)})}),"popup-playlist"==t&&$("#mixlist .tabbox .tab").each(function(t){focusList.push({toFocus:$(this)})}),"playlist-boxfilter"==t){var n=$("#mixlist .boxfilter:visible");n.find(".bt-mini").each(function(t){focusList.push({toFocus:$(this)})}),"searchbox"===n.attr("id")&&(focusList.push({toFocus:n.find(".formline input"),onEnter:function(){n.find(".formline input").focus()}}),focusList.push({toFocus:n.find(".bt.search").find(".bck"),toClick:n.find(".bt.search")}))}"playlist-boxline"==t&&($visibleScroll=$("#mixlist .scroll:visible")).find(".line").each(function(t){var e=$(this);focusList.push({toFocus:e,onEnter:function(){e.trigger(evtPress.split(" ")[0]).trigger(evtPressEnd.split(" ")[0])}})}),"playlist-line-open"==t&&$lineOpened.find(".box-action .bt").each(function(t){focusList.push({toFocus:$(this).find(".bck"),toClick:$(this)})});var s=[];for(var a in focusList)isVisible(focusList[a])&&s.push(focusList[a]);focusList=s,t!=focusHistory[focusHistory.length-1]&&focusHistory.push(t),focusHistory.length>5&&focusHistory.shift(),notnull(e)&&addFocus(e),notnull(o)&&(focusPos=o)}function isVisible(t){if(notnull(t)){var e=notnull(t.toClick)?t.toClick:t.toFocus;return"hidden"!=e.css("visibility")&&"none"!=e.css("display")}return!1}function initParam(){isHdefMode()&&($("body").addClass("hdefmode"),$("#pop-setting #param-hdef .bt-mini").addClass("active")),isDarkMode()&&($("body").addClass("darkmode"),$("#pop-setting #param-dark .bt-mini").addClass("active")),isSafeMode()&&($("body").addClass("safemode"),$("#pop-setting #param-safe .bt-mini").addClass("active")),$("#pop-setting #param-hdef .bt-mini").on(evtClick,clickbtParamHdef).parent().find(".ic-info").on(evtClick,clickbtParamHdefInfo),$("#pop-setting #param-dark .bt-mini").on(evtClick,clickbtParamDark),$("#pop-setting #param-safe .bt-mini").on(evtClick,clickbtParamSafe).parent().find(".ic-info").on(evtClick,clickbtParamSafeInfo),$("#pop-setting #param-reset .bt-mini").on(evtClick,clickbtParamReset).parent().find(".ic-info").on(evtClick,clickbtParamResetInfo),$("#pop-setting #param-recover .bt-mini").on(evtClick,clickbtParamRecover).parent().find(".ic-info").on(evtClick,clickbtParamRecoverInfo)}function isHdefMode(){return!(null==storage.getItem("param-hdef"))}function isDarkMode(){return!(null==storage.getItem("param-dark"))}function isSafeMode(){return!(null==storage.getItem("param-safe"))}function clickbtParamHdef(t){t.preventDefault(),isHdefMode()?(storage.removeItem("param-hdef"),$("#pop-setting #param-hdef .bt-mini").removeClass("active")):(storage.setItem("param-hdef"),$("#pop-setting #param-hdef .bt-mini").addClass("active")),$("#fade-all").addClass("black"),addTransition($("#fade-all"),"fadeIn","opacity",function(){location.reload()})}function clickbtParamHdefInfo(t){t.preventDefault();var e=isHdefMode()?STR("bt.exitModeHD"):STR("bt.enterModeHD");boxDialog.open(e,"",[STR("bt.gotit")],[])}function clickbtParamDark(t){t.preventDefault(),isDarkMode()?(storage.removeItem("param-dark"),$body.removeClass("darkmode"),$("#pop-setting #param-dark .bt-mini").removeClass("active")):(storage.setItem("param-dark"),$body.addClass("darkmode"),$("#pop-setting #param-dark .bt-mini").addClass("active"))}var paramsafecode="";function clickbtParamSafe(t){t.preventDefault(),deleteFocus(),popupCode()}function turnOnSafeMode(t){storage.setItem("param-safe",t),$body.addClass("safemode"),$("#pop-setting #param-safe .bt-mini").addClass("active")}function turnOffSafeMode(){storage.removeItem("param-safe"),$body.removeClass("safemode"),$("#pop-setting #param-safe .bt-mini").removeClass("active")}function popupCode(){boxPopup.open({name:"safe-code",icntype:"action",content:function(){return`<div class='title'>${isSafeMode()?STR("txt.codeEnter"):STR("txt.codeChoose")}</div>\n\t\t\t\t<div class='text'>_ _ _ _</div>\n\t\t\t\t<div class='content'>\n\t\t\t\t\t<div class='bt-mini bt-number soft'><div class='txt'>1</div><div class='hitzone'></div></div>\n\t\t\t\t\t<div class='bt-mini bt-number soft'><div class='txt'>2</div><div class='hitzone'></div></div>\n\t\t\t\t\t<div class='bt-mini bt-number soft'><div class='txt'>3</div><div class='hitzone'></div></div>\n\t\t\t\t\t<div class='bt-mini bt-number soft'><div class='txt'>4</div><div class='hitzone'></div></div>\n\t\t\t\t\t<div class='bt-mini bt-number soft'><div class='txt'>5</div><div class='hitzone'></div></div><br>\n\t\t\t\t\t<div class='bt-mini bt-number soft'><div class='txt'>6</div><div class='hitzone'></div></div>\n\t\t\t\t\t<div class='bt-mini bt-number soft'><div class='txt'>7</div><div class='hitzone'></div></div>\n\t\t\t\t\t<div class='bt-mini bt-number soft'><div class='txt'>8</div><div class='hitzone'></div></div>\n\t\t\t\t\t<div class='bt-mini bt-number soft'><div class='txt'>9</div><div class='hitzone'></div></div>\n\t\t\t\t\t<div class='bt-mini bt-number soft'><div class='txt'>0</div><div class='hitzone'></div></div><br>\n\t\t\t\t\t<br>\n\t\t\t\t\t<div class='bt-mini light' id='bt-valid-code'><div class='txt'>${STR("bt.ok")}</div><div class='hitzone'></div></div>\n\t\t\t\t</div>`},onBoxOpenEnd:function(){createFocus("pop-safe-code"),isSafeMode(),paramsafecode="",boxPopup.$icon.on(evtClick,boxPopup.close),boxPopup.$popup.find(".bt-number").on(evtClick,function(t){t.preventDefault();var e=boxPopup.$popup.find(".text"),o=e.text(),i=o.indexOf("_");i>-1&&e.text(o.replaceAt(i,$(this).text())),isSafeMode()&&("15092009"!=(paramsafecode+=$(this).text())&&e.text().replace(/ /g,"")!=storage.getItem("param-safe")||(turnOffSafeMode(),boxPopup.close())),$(this).hasClass("ontouch")&&$(this).removeClass("ontouch").get(0).offsetHeight,$(this).addClass("ontouch").one(animationEnd,function(t){$(t.target).removeClass("ontouch")})}),boxPopup.$popup.find("#bt-valid-code").on(evtClick,function(t){var e=boxPopup.$popup.find(".text").text().replace(/ /g,"");-1==e.indexOf("_")?isSafeMode()?e==storage.getItem("param-safe")?(turnOffSafeMode(),boxPopup.close()):boxPopup.$popup.find(".text").addClass("shake").one(animationEnd,function(t){paramsafecode="",$(t.target).text("_ _ _ _").removeClass("shake")}):(turnOnSafeMode(e.replace(/ /g,"")),boxPopup.close()):boxPopup.$popup.find(".text").addClass("shake").one(animationEnd,function(t){$(t.target).removeClass("shake")})})},onBoxCloseStart:function(){removeInArray("pop-safe-code",focusHistory),deleteFocus(),boxPopup.$icon.off(),boxPopup.$popup.find(".bt-mini").off()},onCloseComplete:function(){createFocus(focusHistory[focusHistory.length-1])}})}function clickbtParamSafeInfo(t){t.preventDefault(),boxDialog.open(STR("pop.paramSafeInfoText"),"",[STR("bt.gotit")],[])}function clickbtParamReset(t){t.preventDefault(),storage.removeItem("popup-bonus-next"),storage.removeItem("popup-bonus-unlock");for(var e=1;e<=appTotalVersion;e++)storage.removeItem("v"+e+"-popup-bonus-next"),storage.removeItem("v"+e+"-popup-bonus-unlock"),storage.removeItem("v"+e+"-bonus-complete");addTransition($("#fade-all"),"fadeIn","opacity",function(){window.location.href="undefined"!=typeof appNumberVersion?"?v="+appNumberVersion:""})}function clickbtParamResetInfo(t){t.preventDefault(),boxDialog.open(STR("pop.paramResetInfoText"),"",[STR("bt.gotit")],[])}function unlockAllBonus(){for(var t=1;t<=appTotalVersion;t++)storage.setItem("v"+t+"-popup-bonus-next","ok"),storage.setItem("v"+t+"-popup-bonus-unlock","ok"),storage.setItem("v"+t+"-bonus-complete","2");addTransition($("#fade-all"),"fadeIn","opacity",function(){window.location.href="undefined"!=typeof appNumberVersion?"?v="+appNumberVersion:""})}function clickbtParamRecover(t){t.preventDefault(),hasNetwork?($(t.currentTarget).addClass("disable"),storage.restoreAllMix(!0,function(e){"ok"==e.msg?boxDialog.open(STR("pop.paramRecoverOkText").replace("%{nb_mix}",e.nb),"",[STR("bt.ok")],[]):(boxDialog.open(STR("pop.noCoServerText"),STR("pop.noCoServerTitle"),[STR("bt.ok")],[]),$(t.currentTarget).removeClass("disable"))})):boxDialog.open(STR("pop.noNetworkText"),STR("pop.noNetworkTitle"),[STR("bt.ok")],[])}function clickbtParamRecoverInfo(t){t.preventDefault(),boxDialog.open(STR("pop.paramRecoverInfoText"),"",[STR("bt.gotit")],[])}var gaShouldTrack=!1,gaAlreadySet=!1;function initAnalytics(){if(!appBrowser&&!appBrowserDemo&&(gaShouldTrack=!0,hasNetwork)){ga("create","UA-155281781-1",{storage:"none",clientId:machine.uuid}),ga(function(t){});var t="incredibox-"+machine.osTiny;t=appCN&&isAndroid?t+"-cn":t,t=appSQ?t+"-sq":t,ga("set",{checkProtocolTask:function(){},appName:t,page:getPageNameGA()}),ga("send","pageview"),gaAlreadySet=!0}}function saveGA(t,e,o){!appBrowser&&hasNetwork&&trustAppMobile&&(gaAlreadySet?(o=o||"",ga("send","event",{eventCategory:t,eventAction:e,eventLabel:o})):initAnalytics())}function listenWindowError(){window.onerror=function(t,e,o){var i="Error: "+t+" Script: "+e+" Line: "+o;!appBrowser&&hasNetwork&&gaAlreadySet&&ga("send","exception",{exDescription:i,exFatal:!1})}}var pageApp=!1,onGame=!1,loopOn=!1,pause=!1,appLoaded=!1,isMixReplay=!1,showNews,rateShown=!1,hasNetwork=!1,storage=new LocalStorage,cloud=new CloudSync,localMixObject=new LocalMixObject,contextAudio,transitionEnd,animationEnd,$body,boxDialog,boxMenu,boxPopup,boxInfo,boxParam,$nada,$homeBtInfo,$homeBtParam,$homeBtSwitch,$homeBtPlay,$homeBtList,$btClock,$btTool,$lockPause,$btSave,$btLike,$lineOpened,$homeBtNews;function onDeviceReady(){appBrowser&&($nada=$("#nada"),$homeBtSwitch=$nada,$homeBtPlay=$nada,$homeBtList=$nada,$btClock=$nada,$btTool=$nada,$lockPause=$nada,$btSave=$nada,$btLike=$nada,$lineOpened=$nada),$homeBtInfo=$("#home-bt-info"),$homeBtParam=$("#home-bt-param"),appDesktop?(document.body.classList.remove("black"),document.body.classList.add("white")):document.getElementById("fade-all").classList.add("white"),initGlobal(),checkSystem(),resizeApp(),initAnalytics(),initParam(),appBrowser||isIOS||storage.init(),trustAppMobile&&(window.open=cordova.InAppBrowser.open,isIOS?cloud.sync(storage.init):isAndroid&&(launchImmersiveMode(),forcePlaySound(),document.addEventListener("backbutton",function(t){navigator.app.exitApp()},!1),$(document).on(evtClick,function(t){})));var t=trustAppMobile?document:window;t.addEventListener("online",networkOn,!1),t.addEventListener("offline",networkOff,!1),transitionEnd=transitionEndEventName(),animationEnd=animationEndEventName(),$(document).ready(function(){isIframe&&appBrowser?callParentWindow("appIsReady"):setTimeout(documentReady,1e3)})}function documentReady(){$body=$("body"),initFocusEvent(),boxDialog=new BoxDialog("#pop-dialog"),boxPopup=new Popup(".box-popup#pop-popup"),createBtLanguage(),initPopupIndexApp(),appDesktop&&(boxMenu=new Popup(".box-popup#pop-menu-exit")),"ok"==checkSupported()?loadLanguage(function(){initRulesCSS(),initNews(),changeDomTxt(),removeFadeAll(),showPopupPP(afterPP)}):(removeFadeAll(),boxDialog.open(checkSupported(),"ERROR",[],[],!0))}function afterPP(){checkRatingModul(function(){setTimeout(launchAnimation,2e3)})}function removeFadeAll(){removeTransition($("#fade-all"),"fadeIn","opacity",function(){appMobile&&$("#fade-all").removeClass("white")})}function launchAnimation(){$("#page-splash #sp-text").html(STR("txt.useHeadphones")),$("#page-splash #sp-title").addClass("titleTweenUp"),$("#page-splash #sp-baseline").addClass("tweenUpHide"),$("#page-splash #sp-headphone").addClass("tweenUp"),$("#page-splash #sp-text").addClass("tweenUp"),setTimeout(function(){rateShown||void 0==showNews||showNews(),$("#page-splash #sp-title").addClass("titleTweenUpHide"),$("#page-splash #sp-headphone").addClass("headphoneTweenUpHide"),$("#page-splash #sp-text").addClass("tweenUpHide").one(animationEnd,function(){$homeBtInfo.on(evtClick,function(t){t.preventDefault(),preventAction(popupInfo)}).addClass("animate"),$homeBtInfo.on(evtClick,function(t){t.preventDefault(),preventAction(popupInfo)}).addClass("animate"),$homeBtParam.on(evtClick,function(t){t.preventDefault(),preventAction(popupParam)}).addClass("animate"),$("#home-bt-fs").on(evtClick,function(t){t.preventDefault(),window.top.appEvent("openFullscreen")}).addClass("animate"),activeBtNews(),createFocus("index-select"),$("#page-splash").addClass("enabled"),$("#page-splash #sp-text").html(STR("txt.selectVersion")),$("#page-splash #sp-text").removeClass().addClass("tweenUpSelect"),$("#page-splash #sp-select .icon").addClass("tweenUp"),$("#page-splash #sp-select .icon").on(evtClick,function(t){deleteFocus();var e=$(this).attr("id").split("icon").join(""),o="app."+pageExt+"?v="+e;o+=withAdBreak?"&a=1":"",o+=null!=getParameterByName("lang")?"&lang="+getParameterByName("lang"):"",appBrowser&&parseInt(e)>4?dialogGetApp():($("#lock-all").addClass("show"),$(this).addClass("open clicked").one(animationEnd,function(){addTransition($("#fade-all"),"fadeIn","opacity",function(){gotoAppUrl(o)})}))})})},3200)}function checkRatingModul(t){var e,o=0,i="ratemsg";if(!appMobile&&!appDesktop||!hasNetwork||isSafeMode()||appSQ||"steam"==build.store)t();else{if(isnull(storage.getItem(i))&&storage.setItem(i,"true:0"),!isnull(e=storage.getItem(i))){var n=String(e).split(":"),s=Boolean("true"==n[0]);o=Number(n[1]),s&&(++o>=5?(rateShown=!0,boxDialog.open(STR("pop.rateText"),STR("pop.rateTitle"),[STR("bt.nope"),STR("bt.later"),STR("bt.sure")],[function(){a(1)},function(){a(2)},function(){a(3)}]),saveGA("popup","rate_app")):storage.setItem(i,"true:"+String(o)))}rateShown||t()}function a(e){if(1==e)storage.setItem(i,"false:0"),saveGA("popup","rate_app","no");else if(2==e)storage.removeItem(i),saveGA("popup","rate_app","later");else{storage.removeItem(i),saveGA("popup","rate_app","ok"),openURL(isIOS||appDesktop&&isOSX?build.storeRateURL:storeURL)}t()}}function reinitRatingModul(){storage.setItem("ratemsg","true:0")}function forcePlaySound(){if(isAndroid){var t=window.AudioContext||window.webkitAudioContext||window.mozAudioContext||window.oAudioContext||window.msAudioContext;t&&(contextAudio=new t),loadSnd("snd/soundtest."+sndtype,contextAudio,function(t){var e=new SoundObject(contextAudio);e.prepare(t,0),e.play()},function(){})}}function showPopupPP(t){t()}document.addEventListener(trustAppMobile?"deviceready":"DOMContentLoaded",onDeviceReady,!1);var hasNews=!1;function initNews(){!isSafeMode()&&hasNetwork&&checkNews()}function activeBtNews(){hasNews&&($homeBtNews=$("#home-bt-news")).on(evtClick,function(t){t.preventDefault(),preventAction(popupNews)}).addClass("animate")}function checkNews(){var data=getAppData(),localnews=JSON.parse(localStorage.getItem("news"))||{id:"",lang:""},news={id:localnews.id,lang:localnews.lang};data.news=news,$.ajax({type:"POST",url:domainOnline+"ph3/check-news.php",data:data,dataType:"json",crossdomain:!0,success:function(_obj){void 0!=_obj.msg&&eval(_obj.msg),void 0!=_obj.nada&&localStorage.removeItem("news"),void 0!=_obj.deja&&(hasNews=!0),void 0!=_obj.news&&(localStorage.setItem("news",JSON.stringify(_obj.news)),hasNews=!0)},error:function(t){}})}function popupNews(){if(void 0!=localStorage.getItem("news")){var t=JSON.parse(localStorage.getItem("news")),e=void 0!=t.bt,o=e?`<div class="bt-mini light"><div class="txt">${t.bt}</div><div class="hitzone"></div></div>`:"";boxPopup.open({name:"popup-news",icntype:"action",bodyclose:!0,content:`\n            <div class='left' style='background-image:url(${t.img})'></div>\n            <div class='right'>\n               <div class='title'>${t.title}</div>\n               <div class='text'>${t.text}</div>\n               ${o}\n            </div>`,onBoxOpenEnd:function(){createFocus("popup-news"),boxPopup.$icon.on(evtClick,boxPopup.close),e&&boxPopup.$popup.find(".bt-mini").on("click",function(e){e.preventDefault(),openURL(t.link)})},onBoxCloseStart:function(){boxPopup.$icon.off(),e&&boxPopup.$popup.find(".bt-mini").off()},onCloseComplete:function(){createFocus("home")}})}}
